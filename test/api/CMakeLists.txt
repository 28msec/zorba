# Copyright 2006-2010 The FLWOR Foundation.
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
# http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

CREATE_TEST_SOURCELIST(APITests
  APITests.cpp
  itemfactory.cpp
  xmldatamanager.cpp
  test_static_context.cpp
  serializer.cpp
  annotations.cpp
  external_function_errors.cpp
  uri_resolvers.cpp
  #validate.cpp
)

# add the executable
ZORBA_GENERATE_STORE_SPECIFIC_EXES(APITests "${APITests}" "" "" "")

# remove the test driver source file
SET (TestsToRun ${APITests})
REMOVE (TestsToRun APITests.cpp)

MESSAGE(STATUS "Adding API tests for CTest")

# add all the ADD_TEST for each testing
FOREACH (test ${TestsToRun})
  GET_FILENAME_COMPONENT(TName ${test} NAME_WE)
  SET (TestName "test/api/${TName}")
  ZORBA_ADD_TEST_ALLSTORES(${TestName} APITests ${TName})
ENDFOREACH(test)

EXPECTED_FAILURE(test/api/test_static_context 3118348)
