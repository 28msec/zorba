module namespace n = "http://www.28msec.com/test";

import module namespace init = "http://www.zorba-xquery.com/modules/store/static-collections/initialization";
import module namespace manip = "http://www.zorba-xquery.com/modules/store/static-collections/manipulation";

declare namespace d = "http://www.28msec.com/d/";

declare collection n:foo as node();

declare automatically maintained non unique value equality index n:index
  on nodes manip:collection(xs:QName("n:foo"))
  by (if (fn:data(d:userrecord/d:company)) then d:userrecord/d:company else "none") as xs:string;

declare %sequential function n:foo()
{
  init:create-collection(xs:QName("n:foo"));
  init:create-index(xs:QName("n:index"));

  manip:insert-nodes(xs:QName("n:foo"), <a/>);
  1;
};
