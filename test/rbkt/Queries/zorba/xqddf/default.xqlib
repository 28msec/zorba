module namespace def = "http://www.28msec.com/blub/default";

import module namespace init = "http://www.zorba-xquery.com/modules/store/static-collections/initialization";
import module namespace manip = "http://www.zorba-xquery.com/modules/store/static-collections/manipulation";

declare collection def:user as node()*;

declare variable $def:user := xs:QName("def:user");
 
declare automatically maintained unique value equality index def:user-by-uid
  on nodes manip:collection(xs:QName("def:user"))
  by xs:string(@uid) as xs:string;

declare variable $def:user-by-uid := xs:QName("def:user-by-uid");


declare sequential function def:init()
{
  init:create-collection($def:user);

  init:create-index($def:user-by-uid);

  manip:insert-nodes($def:user,
    (
      <user uid='1'>Matthias</user>,
      <user uid='2'>David</user>,
      <user uid='3'>Gabriel</user>,
      <user uid='4'>William</user>
    )
  );
};


declare function def:query()
{
  manip:probe-index-point-value(xs:QName("def:user-by-uid"), 1)
};
