module namespace def = "http://www.28msec.com/blub/default";

import module namespace xqddf = "http://www.zorba-xquery.com/modules/xqddf";

declare collection def:user as node()*;

declare variable $def:user := xs:QName("def:user");
 
declare automatically maintained unique value equality index def:user-by-uid
  on nodes xqddf:collection(xs:QName("def:user"))
  by xs:string(@uid) as xs:string;

declare variable $def:user-by-uid := xs:QName("def:user-by-uid");


declare sequential function def:init()
{
  xqddf:create-collection($def:user);

  xqddf:create-index($def:user-by-uid);

  xqddf:insert-nodes($def:user,
    (
      <user uid='1'>Matthias</user>,
      <user uid='2'>David</user>,
      <user uid='3'>Gabriel</user>,
      <user uid='4'>William</user>
    )
  );
};


declare function def:query()
{
  xqddf:probe-index-point(xs:QName("def:user-by-uid"), 1)
};
