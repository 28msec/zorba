<?php
/*
 * Copyright 2006-2008 The FLWOR Foundation.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
require '@phpPath@/ZorbaXQueryProcessor.php';

function testAssertion($val, $label)
{
  if($val == false) {
    throw new Exception("Test ".$label." failed");
  }
}
/* Test 1 */
$xquery = new ZorbaXQueryProcessor();
$xquery->importQuery('1+1');
$result = $xquery->executeToXML();
testAssertion($result == '2', "1+1");

/* Test 2 */
$query = <<<'XQ'
declare variable $foo as xs:string external;
declare variable $bar as xs:integer external;
declare variable $doc1 as document-node() external;
declare variable $doc2 as document-node() external;

$foo, $bar, $doc1, $doc2
XQ;

$xquery->importQuery($query);

$xquery->setVariable("foo", "bar");
$xquery->setVariable("bar", 3);

$doc = simplexml_load_string('<root />');
$xquery->setVariable("doc1", $doc);

$doc = $xquery->parseXML("<root />");
$xquery->setVariable("doc2", $doc);

testAssertion($xquery->executeToXML() == "bar 3<root /><root />", "Scalar Types");
?>
