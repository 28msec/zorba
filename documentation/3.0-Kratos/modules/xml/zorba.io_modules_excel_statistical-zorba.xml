<xqdoc:xqdoc xmlns:xqdoc="http://www.xqdoc.org/1.0"><xqdoc:control><xqdoc:date>2013-12-04T01:28:38.942159+01:00</xqdoc:date><xqdoc:version>1.0</xqdoc:version></xqdoc:control><xqdoc:module type="library"><xqdoc:uri>http://zorba.io/modules/excel/statistical-zorba</xqdoc:uri><xqdoc:name>statistical-zorba</xqdoc:name><xqdoc:comment><xqdoc:description> This module implements some Excel 2003 statistical functions
 that cannot be implemented with standard XQuery functions.
 It uses Zorba specific functions.
</xqdoc:description><xqdoc:author>Daniel Turcanu</xqdoc:author><xqdoc:see>http://office.microsoft.com/en-us/excel/CH062528311033.aspx</xqdoc:see><xqdoc:custom tag="project">Zorba/Excel/Statistical Zorba</xqdoc:custom><xqdoc:custom tag="language">xquery</xqdoc:custom><xqdoc:custom tag="version">3.0</xqdoc:custom><xqdoc:custom tag="encoding">utf-8</xqdoc:custom></xqdoc:comment><xqdoc:custom tag="namespaces"><xqdoc:namespace prefix="excel" uri="http://zorba.io/modules/excel/statistical-zorba" isSchema="false"/><xqdoc:namespace prefix="excel-err" uri="http://zorba.io/modules/excel/errors" isSchema="false"/><xqdoc:namespace prefix="excel-math" uri="http://zorba.io/modules/excel/math" isSchema="false"/><xqdoc:namespace prefix="excel-statistical" uri="http://zorba.io/modules/excel/statistical" isSchema="false"/><xqdoc:namespace prefix="math" uri="http://www.w3.org/2005/xpath-functions/math" isSchema="false"/><xqdoc:namespace prefix="ver" uri="http://zorba.io/options/versioning" isSchema="false"/></xqdoc:custom></xqdoc:module><xqdoc:imports><xqdoc:import type="library"><xqdoc:uri>http://zorba.io/modules/excel/math</xqdoc:uri></xqdoc:import><xqdoc:import type="library"><xqdoc:uri>http://zorba.io/modules/excel/statistical</xqdoc:uri></xqdoc:import></xqdoc:imports><xqdoc:variables/><xqdoc:collections/><xqdoc:indexes/><xqdoc:functions><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Estimates standard deviation based on a sample.
 The standard deviation is a measure of how widely values are dispersed
   from the average value (the mean).
 It is computed with formula:
 sqrt( sum((x-average_x)^2) / (n-1) )    = sqrt ( VAR(numbers) )
</xqdoc:description><xqdoc:param>$numbers the sequence of numbers or values castable to numeric The sequence can be of any length, from 1 up.</xqdoc:param><xqdoc:return>the standard deviation, as numeric type</xqdoc:return><xqdoc:error>excel-err:Value if the parameters cannot be casted to numeric type</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052092771033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/statistical/stdev1.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:stdev</xqdoc:name><xqdoc:signature>declare function excel:stdev($numbers as xs:anyAtomicType+) as xs:anyAtomicType</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>numbers</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions/math</xqdoc:uri><xqdoc:name>sqrt</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/statistical</xqdoc:uri><xqdoc:name>var</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Estimates standard deviation based on a sample.
 The standard deviation is a measure of how widely values are dispersed
   from the average value (the mean).
 It is computed with formula:
 sqrt( sum((x-average_x)^2) / (n-1) )    = sqrt ( VARA(numbers) )
</xqdoc:description><xqdoc:param>$numbers the sequence of numbers or values castable to numeric The sequence can be of any length, from 1 up.</xqdoc:param><xqdoc:return>the standard deviation, as numeric type</xqdoc:return><xqdoc:error>excel-err:Value if the parameters cannot be casted to numeric type</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052092791033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/statistical/stdeva1.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:stdeva</xqdoc:name><xqdoc:signature>declare function excel:stdeva($numbers as xs:anyAtomicType+) as xs:anyAtomicType</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>numbers</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions/math</xqdoc:uri><xqdoc:name>sqrt</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/statistical</xqdoc:uri><xqdoc:name>vara</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Calculates standard deviation based on the entire population given as arguments.
 The standard deviation is a measure of how widely values are dispersed from
   the average value (the mean).
 It is computed with formula:
 sqrt( sum((x-average_x)^2) / n )    = sqrt ( VARP(numbers) )
</xqdoc:description><xqdoc:param>$numbers the sequence of numbers or values castable to numeric The sequence can be of any length, from 1 up.</xqdoc:param><xqdoc:return>the standard deviation, as numeric type</xqdoc:return><xqdoc:error>excel-err:Value if the parameters cannot be casted to numeric type</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052092811033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/statistical/stdevp1.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:stdevp</xqdoc:name><xqdoc:signature>declare function excel:stdevp($numbers as xs:anyAtomicType+) as xs:anyAtomicType</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>numbers</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions/math</xqdoc:uri><xqdoc:name>sqrt</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/statistical</xqdoc:uri><xqdoc:name>varp</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Calculates standard deviation based on the entire population given as arguments.
 The standard deviation is a measure of how widely values are dispersed from
   the average value (the mean).
 It is computed with formula:
 sqrt( sum((x-average_x)^2) / n )    = sqrt ( VARPA(numbers) )
</xqdoc:description><xqdoc:param>$numbers the sequence of numbers or values castable to numeric The sequence can be of any length, from 1 up.</xqdoc:param><xqdoc:return>the standard deviation, as numeric type</xqdoc:return><xqdoc:error>excel-err:Value if the parameters cannot be casted to numeric type</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052092831033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/statistical/stdevpa1.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:stdevpa</xqdoc:name><xqdoc:signature>declare function excel:stdevpa($numbers as xs:anyAtomicType+) as xs:anyAtomicType</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>numbers</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions/math</xqdoc:uri><xqdoc:name>sqrt</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/statistical</xqdoc:uri><xqdoc:name>varpa</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Moved from math module.
 Returns a subtotal in a sequence of numbers.
 The function applied is given by $function_num.
</xqdoc:description><xqdoc:param>$function_num <dl>defines the function to be applied on sequence values. The possible values are: <dt>1 or 101</dt> <dd> AVERAGE</dd> <dt>2 or 102</dt> <dd> COUNT</dd> <dt>3 or 103</dt> <dd> COUNTA</dd> <dt>4 or 104</dt> <dd> MAX</dd> <dt>5 or 105</dt> <dd> MIN</dd> <dt>6 or 106</dt> <dd> PRODUCT</dd> <dt>7 or 107</dt> <dd> STDEV</dd> <dt>8 or 108</dt> <dd> STDEVP</dd> <dt>9 or 109</dt> <dd> SUM</dd> <dt>10 or 110</dt> <dd> VAR</dd> <dt>11 or 111</dt> <dd> VARP</dd></dl> In this implementation there is no difference between x and 10x.<p/></xqdoc:param><xqdoc:param>$numbers the sequence of numbers or values castable to numeric. The sequence can be of any length.</xqdoc:param><xqdoc:return>The function result, as numeric type</xqdoc:return><xqdoc:error>depends on the function called</xqdoc:error><xqdoc:error>excel-err:Num if $function_num is not a value between 1 .. 11 or 101 .. 111</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052092881033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/statistical/priority1/subtotal1.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/statistical/priority1/subtotal2.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/statistical/priority1/subtotal3.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/statistical/priority1/subtotal4.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/statistical/priority1/subtotal5.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/statistical/priority1/subtotal6.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/statistical/priority1/subtotal7.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/statistical/priority1/subtotal8.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/statistical/priority1/subtotal9.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/statistical/priority1/subtotal10.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/statistical/priority1/subtotal11.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:subtotal</xqdoc:name><xqdoc:signature>declare function excel:subtotal($function_num as xs:integer, $numbers as xs:anyAtomicType*) as xs:anyAtomicType</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>function_num</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>numbers</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/math</xqdoc:uri><xqdoc:name>product</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/math</xqdoc:uri><xqdoc:name>sum</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/statistical-zorba</xqdoc:uri><xqdoc:name>stdev</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/statistical-zorba</xqdoc:uri><xqdoc:name>stdevp</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/statistical</xqdoc:uri><xqdoc:name>average</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/statistical</xqdoc:uri><xqdoc:name>count</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/statistical</xqdoc:uri><xqdoc:name>counta</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/statistical</xqdoc:uri><xqdoc:name>max</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/statistical</xqdoc:uri><xqdoc:name>min</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/statistical</xqdoc:uri><xqdoc:name>var</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/statistical</xqdoc:uri><xqdoc:name>varp</xqdoc:name></xqdoc:invoked></xqdoc:function></xqdoc:functions></xqdoc:xqdoc>