<xqdoc:xqdoc xmlns:xqdoc="http://www.xqdoc.org/1.0"><xqdoc:control><xqdoc:date>2013-12-04T01:28:38.942159+01:00</xqdoc:date><xqdoc:version>1.0</xqdoc:version></xqdoc:control><xqdoc:module type="library"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>http-client-wrapper</xqdoc:name><xqdoc:comment><xqdoc:description> <p>This module provides conversion functions between the
 XML Expath http-client request and response formats and the
 JSON http-client request and response formats used by the
 <code>http://zorba.io/modules/http-client</code> module.
 </p>
 <p>This module is reserved for internal use by the
 <code>http://www.zorba-xquery.com/modules/http-client</code> and the
 <code>http://expath.org/ns/http-client</code> modules.
 This module may be removed at any time. Method signature and
 semantics may change.
 </p>
</xqdoc:description><xqdoc:author>Federico Cavalieri</xqdoc:author><xqdoc:custom tag="project">Zorba/Input Output/HTTP Client</xqdoc:custom><xqdoc:custom tag="language">xquery</xqdoc:custom><xqdoc:custom tag="version">3.0</xqdoc:custom><xqdoc:custom tag="encoding">utf-8</xqdoc:custom></xqdoc:comment><xqdoc:custom tag="namespaces"><xqdoc:namespace prefix="an" uri="http://zorba.io/annotations" isSchema="false"/><xqdoc:namespace prefix="err" uri="http://www.w3.org/2005/xqt-errors" isSchema="false"/><xqdoc:namespace prefix="error" uri="http://expath.org/ns/error" isSchema="false"/><xqdoc:namespace prefix="http-schema" uri="http://expath.org/ns/http-client" isSchema="true"/><xqdoc:namespace prefix="http-wrapper" uri="http://zorba.io/modules/http-client-wrapper" isSchema="false"/><xqdoc:namespace prefix="jn" uri="http://jsoniq.org/functions" isSchema="false"/><xqdoc:namespace prefix="json-http" uri="http://zorba.io/modules/http-client" isSchema="false"/><xqdoc:namespace prefix="libjn" uri="http://jsoniq.org/function-library" isSchema="false"/><xqdoc:namespace prefix="ser" uri="http://www.w3.org/2010/xslt-xquery-serialization" isSchema="false"/><xqdoc:namespace prefix="ver" uri="http://zorba.io/options/versioning" isSchema="false"/></xqdoc:custom></xqdoc:module><xqdoc:imports><xqdoc:import type="schema"><xqdoc:uri>http://expath.org/ns/http-client</xqdoc:uri></xqdoc:import><xqdoc:import type="library"><xqdoc:uri>http://expath.org/ns/error</xqdoc:uri></xqdoc:import><xqdoc:import type="library"><xqdoc:uri>http://zorba.io/modules/http-client</xqdoc:uri></xqdoc:import><xqdoc:import type="library"><xqdoc:uri>http://jsoniq.org/function-library</xqdoc:uri></xqdoc:import></xqdoc:imports><xqdoc:variables/><xqdoc:collections/><xqdoc:indexes/><xqdoc:functions><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> <p>This function sends an HTTP request and returns the corresponding response.
 This function is declared sequential and can be used to issue
 requests which change the state of the server.</p>
 <p>Its inputs, outputs, and behavior are identical to the
 <a href="http://expath.org/spec/http-client">EXPath http-client</a>'s
 send-request() function (except that HTML responses are not tidied
 into XML - see <a href="#expath_relation">the note above</a>). It
 is provided here for use in Zorba installations that do not have
 the EXPath module available. If you have the option of using the
 EXPath module instead of this function, please do so, as it will
 allow your application to be more interoperable between different
 XQuery engines.</p>
 <p>Full documentation of the $request parameter can be found in
 <a href="http://expath.org/spec/http-client#d2e183">the EXPath
 specification</a>.</p>
</xqdoc:description><xqdoc:param>$request Contains the various parameters of the request (see above).</xqdoc:param><xqdoc:param>$href The URL to which the request will be made (see <a href="#url_string">note</a> above). If this parameter is specified, it will override the "href" attribute of $request.</xqdoc:param><xqdoc:param>$bodies is the request body content, for HTTP methods that can contain a body in the request (i.e. POST and PUT). It is an error if this param is not the empty sequence for methods</xqdoc:param><xqdoc:return><a href="#standard_return">standard http-client return type</a>.</xqdoc:return><xqdoc:error>error:HC001 An HTTP error occurred.</xqdoc:error><xqdoc:error>error:HC002 Error parsing the response content as XML.</xqdoc:error><xqdoc:error>error:HC003 With a multipart response, the override-media-type must be either a multipart media type or application/octet-stream.</xqdoc:error><xqdoc:error>error:HC004 The src attribute on the body element is mutually exclusive with all other attribute (except the media-type).</xqdoc:error><xqdoc:error>error:HC005 The input request element is not valid.</xqdoc:error><xqdoc:error>error:HC006 A timeout occurred waiting for the response.</xqdoc:error><xqdoc:error>error:HCV02 Trying to follow a redirect of a POST, PUT, or DELETE request</xqdoc:error></xqdoc:comment><xqdoc:name>http-wrapper:http-sequential-request</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function http-wrapper:http-sequential-request($request as element(*)?, $href as xs:string?, $bodies as item()*) as item()+</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>request</xqdoc:name><xqdoc:type occurrence="?">element(*)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>href</xqdoc:name><xqdoc:type occurrence="?">xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>bodies</xqdoc:name><xqdoc:type occurrence="*">item()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="+">item()+</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>data</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>local-name-from-QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>json-request</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>xml-response</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client</xqdoc:uri><xqdoc:name>send-request</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> <p>This function sends an HTTP request and returns the corresponding response.
 This function is declared non-deterministic and should only be used to issue
 requests which do not change the state of the server.</p>
 <p>Its inputs, outputs, and behavior are identical to the
 <a href="http://expath.org/spec/http-client">EXPath http-client</a>'s
 send-request() function (except that HTML responses are not tidied
 into XML - see <a href="#expath_relation">the note above</a>). It
 is provided here for use in Zorba installations that do not have
 the EXPath module available. If you have the option of using the
 EXPath module instead of this function, please do so, as it will
 allow your application to be more interoperable between different
 XQuery engines.</p>
 <p>Full documentation of the $request parameter can be found in
 <a href="http://expath.org/spec/http-client#d2e183">the EXPath
 specification</a>.</p>
</xqdoc:description><xqdoc:param>$request Contains the various parameters of the request (see above).</xqdoc:param><xqdoc:param>$href The URL to which the request will be made (see <a href="#url_string">note</a> above). If this parameter is specified, it will override the "href" attribute of $request.</xqdoc:param><xqdoc:param>$bodies is the request body content, for HTTP methods that can contain a body in the request (i.e. POST and PUT). It is an error if this param is not the empty sequence for methods</xqdoc:param><xqdoc:return><a href="#standard_return">standard http-client return type</a>.</xqdoc:return><xqdoc:error>error:HC001 An HTTP error occurred.</xqdoc:error><xqdoc:error>error:HC002 Error parsing the response content as XML.</xqdoc:error><xqdoc:error>error:HC003 With a multipart response, the override-media-type must be either a multipart media type or application/octet-stream.</xqdoc:error><xqdoc:error>error:HC004 The src attribute on the body element is mutually exclusive with all other attribute (except the media-type).</xqdoc:error><xqdoc:error>error:HC005 The input request element is not valid.</xqdoc:error><xqdoc:error>error:HC006 A timeout occurred waiting for the response.</xqdoc:error><xqdoc:error>error:HCV02 Trying to follow a redirect of a POST, PUT, or DELETE request</xqdoc:error></xqdoc:comment><xqdoc:name>http-wrapper:http-nondeterministic-request</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function http-wrapper:http-nondeterministic-request($request as element(*)?, $href as xs:string?, $bodies as item()*) as item()+</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>request</xqdoc:name><xqdoc:type occurrence="?">element(*)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>href</xqdoc:name><xqdoc:type occurrence="?">xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>bodies</xqdoc:name><xqdoc:type occurrence="*">item()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="+">item()+</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>data</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>local-name-from-QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>json-request</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>xml-response</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client</xqdoc:uri><xqdoc:name>send-nondeterministic-request</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Private function used internally by this module.
 This function accepts a JSON HTTP module response, as
 used by the http://zorba.io/modules/http-client module
 and returns its EXPath XML representation.
</xqdoc:description><xqdoc:param>$response a JSON response representation.</xqdoc:param><xqdoc:param>$override-media-type if specified, is used in place of all body media-types in the response.</xqdoc:param><xqdoc:return>EXPath XML response representation.</xqdoc:return><xqdoc:error>error:HC002 Error parsing the response content as XML.</xqdoc:error></xqdoc:comment><xqdoc:name>http-wrapper:xml-response</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:xml-response($response as object(), $override-media-type as xs:string?) as item()+</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>response</xqdoc:name><xqdoc:type>object()</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>override-media-type</xqdoc:name><xqdoc:type occurrence="?">xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="+">item()+</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://jsoniq.org/function-library</xqdoc:uri><xqdoc:name>descendant-objects</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>get-bodies</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>xml-body</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>xml-headers</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>xml-multipart</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Private function used internally by this module.
 This function accepts a JSON HTTP module response, as
 used by the http://zorba.io/modules/http-client module
 and returns its EXPath XML representation.
 If the body media-type indicates that the response body
 has an XML content, the response body is parsed as XML
 before being returned.
</xqdoc:description><xqdoc:param>$bodies a sequence JSON bodies.</xqdoc:param><xqdoc:param>$override-media-type if specified, is used in place of all body media-types.</xqdoc:param><xqdoc:return>body contents.</xqdoc:return><xqdoc:error>error:HC002 Error parsing the response content as XML.</xqdoc:error></xqdoc:comment><xqdoc:name>http-wrapper:get-bodies</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:get-bodies($bodies as object()*, $override-media-type as xs:string?) as item()*</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>bodies</xqdoc:name><xqdoc:type occurrence="*">object()</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>override-media-type</xqdoc:name><xqdoc:type occurrence="?">xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="*">item()*</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>contains</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>ends-with</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>parse-xml</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>substring-before</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Private function used internally by this module.
 This function accepts the headers portion of a JSON HTTP module
 response, as used by the http://zorba.io/modules/http-client module
 and returns its EXPath XML representation.
</xqdoc:description><xqdoc:param>$headers JSON representation of an headers set.</xqdoc:param><xqdoc:return>XML representation of the given headers.</xqdoc:return></xqdoc:comment><xqdoc:name>http-wrapper:xml-headers</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:xml-headers($headers as object()?) as element(*)*</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>headers</xqdoc:name><xqdoc:type occurrence="?">object()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="*">element(*)*</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://jsoniq.org/functions</xqdoc:uri><xqdoc:name>keys</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>exists</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Private function used internally by this module.
 This function accepts the body portion of a JSON HTTP module
 response, as used by the http://zorba.io/modules/http-client module
 and returns its EXPath XML representation.
</xqdoc:description><xqdoc:param>$body JSON representation of a body.</xqdoc:param><xqdoc:return>XML representation of the given body.</xqdoc:return></xqdoc:comment><xqdoc:name>http-wrapper:xml-body</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:xml-body($body as object()?) as element(*)?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>body</xqdoc:name><xqdoc:type occurrence="?">object()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">element(*)?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>exists</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Private function used internally by this module.
 This function accepts the multipart portion of a JSON HTTP module
 response, as used by the http://zorba.io/modules/http-client module
 and returns its EXPath XML representation.
</xqdoc:description><xqdoc:param>$multipart JSON representation of a multipart.</xqdoc:param><xqdoc:return>XML representation of the given multipart.</xqdoc:return></xqdoc:comment><xqdoc:name>http-wrapper:xml-multipart</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:xml-multipart($multipart as object()?) as element(*)?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>multipart</xqdoc:name><xqdoc:type occurrence="?">object()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">element(*)?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://jsoniq.org/functions</xqdoc:uri><xqdoc:name>members</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>exists</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>xml-body</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>xml-headers</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> Private function used internally by this module.
 This function accepts an XML EXPath HTTP request and returns its
 JSON representation, as used by the http://zorba.io/modules/http-client
 module.
</xqdoc:description><xqdoc:param>$request XML EXPath HTTP request.</xqdoc:param><xqdoc:param>$href is the HTTP or HTTPS URI to send the request to. If specified, any href URI specified in the request element is ignored.</xqdoc:param><xqdoc:param>$bodies the request bodies content.</xqdoc:param><xqdoc:return>JSON HTTP request representation.</xqdoc:return><xqdoc:error>error:HC005 The specified request object is not valid.</xqdoc:error></xqdoc:comment><xqdoc:name>http-wrapper:json-request</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:json-request($request as element(*)?, $href as xs:string?, $bodies as item()*) as item()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>request</xqdoc:name><xqdoc:type occurrence="?">element(*)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>href</xqdoc:name><xqdoc:type occurrence="?">xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>bodies</xqdoc:name><xqdoc:type occurrence="*">item()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>item()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>string</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>check-params</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>json-authentication</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>json-body</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>json-headers</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>json-multipart</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>json-options</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>set-content-type</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Private function used internally by this module.
 This function accepts an XML EXPath HTTP request and returns the
 JSON representation of its authentication options, as used by the
 http://zorba.io/modules/http-client module.
</xqdoc:description><xqdoc:param>$request XML EXPath HTTP request.</xqdoc:param><xqdoc:return>JSON HTTP request authentication representation.</xqdoc:return></xqdoc:comment><xqdoc:name>http-wrapper:json-authentication</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:json-authentication($request as element(*)) as object()?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>request</xqdoc:name><xqdoc:type>element(*)</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">object()?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2001/XMLSchema</xqdoc:uri><xqdoc:name>boolean</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>data</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>string</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Private function used internally by this module.
 This function accepts an XML EXPath HTTP request and returns the
 JSON representation of its options, as used by the
 http://zorba.io/modules/http-client module.
</xqdoc:description><xqdoc:param>$request XML EXPath HTTP request.</xqdoc:param><xqdoc:return>JSON HTTP request options representation.</xqdoc:return></xqdoc:comment><xqdoc:name>http-wrapper:json-options</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:json-options($request as element(*)) as object()?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>request</xqdoc:name><xqdoc:type>element(*)</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">object()?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2001/XMLSchema</xqdoc:uri><xqdoc:name>boolean</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>data</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>string</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Private function used internally by this module.
 This function accepts a sequence of headers in the XML EXPath HTTP request
 format and returns their JSON representation, as used by the
 http://zorba.io/modules/http-client module.
</xqdoc:description><xqdoc:param>$headers XML EXPath HTTP headers.</xqdoc:param><xqdoc:return>JSON HTTP request headers representation.</xqdoc:return></xqdoc:comment><xqdoc:name>http-wrapper:json-headers</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:json-headers($headers as element(*)*) as object()?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>headers</xqdoc:name><xqdoc:type occurrence="*">element(*)</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">object()?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>string-join</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Private function used internally by this module.
 This function accept a body element in the XML EXPath HTTP request
 format and returns its JSON representation, as used by the
 http://zorba.io/modules/http-client module.
</xqdoc:description><xqdoc:param>$body XML EXPath HTTP body element.</xqdoc:param><xqdoc:param>$content body content.</xqdoc:param><xqdoc:return>JSON HTTP request headers representation.</xqdoc:return></xqdoc:comment><xqdoc:name>http-wrapper:json-body</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:json-body($body as element(*)?, $content as item()*) as object()?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>body</xqdoc:name><xqdoc:type occurrence="?">element(*)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>content</xqdoc:name><xqdoc:type occurrence="*">item()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">object()?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>string</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>produce-content</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Private function used internally by this module.
 This function serializes a request body.
</xqdoc:description><xqdoc:param>$body request contents.</xqdoc:param><xqdoc:return>serialized body.</xqdoc:return></xqdoc:comment><xqdoc:name>http-wrapper:produce-content</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:produce-content($body as element(*), $content as item()*) as xs:string</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>body</xqdoc:name><xqdoc:type>element(*)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>content</xqdoc:name><xqdoc:type occurrence="*">item()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:string</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>serialize</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>serialization-parameters</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Private function used internally by this module.
 This function accept a body element in the XML EXPath HTTP request
 format and returns the serializer parameters to be used to serialize
 its content.
</xqdoc:description><xqdoc:param>$body XML EXPath HTTP body element.</xqdoc:param><xqdoc:return>serializer parameters.</xqdoc:return></xqdoc:comment><xqdoc:name>http-wrapper:serialization-parameters</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:serialization-parameters($body as element(*)) as element(*)</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>body</xqdoc:name><xqdoc:type>element(*)</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>element(*)</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>local-name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>string</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>default-serialization-parameters</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Private function used internally by this module.
 This function return this module default serialization parameters.
</xqdoc:description><xqdoc:param>$body XML EXPath HTTP body element.</xqdoc:param><xqdoc:return>serializer parameters.</xqdoc:return></xqdoc:comment><xqdoc:name>http-wrapper:default-serialization-parameters</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:default-serialization-parameters($body as element(*)) as element(*)*</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>body</xqdoc:name><xqdoc:type>element(*)</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="*">element(*)*</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>string</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Private function used internally by this module.
 This function accept a multipart element in the XML EXPath HTTP request
 format and returns its JSON representation, as used by the
 http://zorba.io/modules/http-client module.
</xqdoc:description><xqdoc:param>$multipart XML EXPath HTTP multipart element.</xqdoc:param><xqdoc:param>$bodies multipart bodies content.</xqdoc:param><xqdoc:return>JSON HTTP request multipart representation.</xqdoc:return></xqdoc:comment><xqdoc:name>http-wrapper:json-multipart</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:json-multipart($multipart as element(*)?, $bodies as item()*) as object()?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>multipart</xqdoc:name><xqdoc:type occurrence="?">element(*)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>bodies</xqdoc:name><xqdoc:type occurrence="*">item()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">object()?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>count</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>local-name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>not</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>string</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>json-part</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> Private function used internally by this module.
 This function accept a part headers, body and content  in the XML
 EXPath HTTP request format and returns its JSON representation, as
 used by the http://zorba.io/modules/http-client module.
</xqdoc:description><xqdoc:param>$headers XML EXPath HTTP header elements.</xqdoc:param><xqdoc:param>$body XML EXPath HTTP body element.</xqdoc:param><xqdoc:param>$content XML EXPath HTTP body content.</xqdoc:param><xqdoc:return>JSON HTTP request part representation.</xqdoc:return></xqdoc:comment><xqdoc:name>http-wrapper:json-part</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:json-part($headers as element(*)*, $body as element(*), $content as item()*) as item()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>headers</xqdoc:name><xqdoc:type occurrence="*">element(*)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>body</xqdoc:name><xqdoc:type>element(*)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>content</xqdoc:name><xqdoc:type occurrence="*">item()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>item()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>json-body</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>json-headers</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> Private function used internally by this module.
 This function checks if the request, href, and bodies parameters
 are consistent.
</xqdoc:description><xqdoc:param>$request The request which needs to be checked.</xqdoc:param><xqdoc:param>$href The href which needs to be checked.</xqdoc:param><xqdoc:param>$bodies The bodies element which needs to be checked.</xqdoc:param><xqdoc:return>true if the parameters are consistent. Otherwise, this function raises an error.</xqdoc:return><xqdoc:error>error:HC004 The src attribute on the body element is mutually exclusive with all other attribute (except the media-type).</xqdoc:error><xqdoc:error>error:HC005 The specified request object is not valid.</xqdoc:error></xqdoc:comment><xqdoc:name>http-wrapper:check-params</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:check-params($request as element(http-schema:request)?, $href as xs:string?, $bodies as item()*) as xs:boolean</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>request</xqdoc:name><xqdoc:type occurrence="?">element(http-schema:request)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>href</xqdoc:name><xqdoc:type occurrence="?">xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>bodies</xqdoc:name><xqdoc:type occurrence="*">item()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:boolean</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>count</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>empty</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>exists</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>not</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>string</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="0"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>true</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> This adds a default method attribute to all body elements which
 don't contain a method attribute.
</xqdoc:description><xqdoc:param>$request The request which need to be copied.</xqdoc:param><xqdoc:return>A copy of $request with all request//body/@method set.</xqdoc:return></xqdoc:comment><xqdoc:name>http-wrapper:set-content-type</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:set-content-type($request as element(http-schema:request)?) as element(http-schema:request)?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>request</xqdoc:name><xqdoc:type occurrence="?">element(http-schema:request)</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">element(http-schema:request)?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>create-body</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>create-multipart</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> This function takes an http-schema:body element, copies it, and
 adds a method attribute to the copy if there is none
 in the original element.
</xqdoc:description><xqdoc:param>$body is the original http-schema:body element</xqdoc:param><xqdoc:return>a http-schema:body element with a corresponding <code>@method</code> attribute</xqdoc:return></xqdoc:comment><xqdoc:name>http-wrapper:create-body</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:create-body($body as element(http-schema:body)) as element(http-schema:body)</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>body</xqdoc:name><xqdoc:type>element(http-schema:body)</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>element(http-schema:body)</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>data</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>starts-with</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> This function takes an http-schema:multipart element, copies it and
 adds a @method attribute to all body elements which don't have
 one.
</xqdoc:description><xqdoc:param>$multipart the original http-schema:multipart</xqdoc:param><xqdoc:return>a copy of $multipart with all $multipart/body/@method set</xqdoc:return></xqdoc:comment><xqdoc:name>http-wrapper:create-multipart</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function http-wrapper:create-multipart($multipart as element(http-schema:multipart)) as element(http-schema:multipart)</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>multipart</xqdoc:name><xqdoc:type>element(http-schema:multipart)</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>element(http-schema:multipart)</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/http-client-wrapper</xqdoc:uri><xqdoc:name>create-body</xqdoc:name></xqdoc:invoked></xqdoc:function></xqdoc:functions></xqdoc:xqdoc>