<xqdoc:xqdoc xmlns:xqdoc="http://www.xqdoc.org/1.0"><xqdoc:control><xqdoc:date>2013-12-04T01:28:38.942159+01:00</xqdoc:date><xqdoc:version>1.0</xqdoc:version></xqdoc:control><xqdoc:module type="library"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>imap</xqdoc:name><xqdoc:comment><xqdoc:description> This module provides functions for accessing and manipulating emails on mail
 servers through the IMAP protocol.
 All functions in this module receive as the first argument the IMAP host and user
 information. This is an element with the type <code>hostInfoType</code> as defined
 in the email schema: <code>http://www.zorba-xquery.com/modules/email</code>.
 For example:
 <pre class="ace-static" ace-mode="xquery">
 &lt;email:hostInfo&gt;
   &lt;email:hostName&gt;imap.example.com&lt;/email:hostName&gt;
   &lt;email:userName&gt;myuser&lt;/email:userName&gt;
   &lt;email:password&gt;mypassword&lt;/email:password&gt;
 &lt;/email:hostInfo&gt;
 </pre>
 The <code>hostInfoType</code> only needs to be in the email schema namespace
 (<code>http://www.zorba-xquery.com/modules/email</code>). It does not need
 to be validated since it's validated by the module.
</xqdoc:description><xqdoc:author>Daniel Thomas, Gabriel Petrovay</xqdoc:author><xqdoc:see><a href="http://www.washington.edu/imap/">c-client library part of UW IMAP toolkit</a></xqdoc:see><xqdoc:custom tag="library"><a href="http://www.washington.edu/imap/">c-client library part of UW IMAP toolkit</a></xqdoc:custom><xqdoc:custom tag="project">Zorba/Input Output/IMAP</xqdoc:custom><xqdoc:custom tag="language">xquery</xqdoc:custom><xqdoc:custom tag="version">3.0</xqdoc:custom><xqdoc:custom tag="encoding">utf-8</xqdoc:custom></xqdoc:comment><xqdoc:custom tag="namespaces"><xqdoc:namespace prefix="an" uri="http://zorba.io/annotations" isSchema="false"/><xqdoc:namespace prefix="email" uri="http://www.zorba-xquery.com/modules/email" isSchema="true"/><xqdoc:namespace prefix="imap" uri="http://www.zorba-xquery.com/modules/email/imap" isSchema="false"/><xqdoc:namespace prefix="ver" uri="http://zorba.io/options/versioning" isSchema="false"/></xqdoc:custom></xqdoc:module><xqdoc:imports><xqdoc:import type="schema"><xqdoc:uri>http://www.zorba-xquery.com/modules/email</xqdoc:uri></xqdoc:import></xqdoc:imports><xqdoc:variables/><xqdoc:collections/><xqdoc:indexes/><xqdoc:functions><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Returns the status of the given mailbox.
 The status of a mailbox contains:
 <ul>
  <li><code>messages</code>: the number of messages in the mailbox</li>
  <li><code>recent</code>: the number of messages flagged as recent</li>
  <li><code>unseen</code>: the number of messages flagged as unseen</li>
  <li><code>uidnext</code>: the next unique identifier that will be assigned to a message</li>
  <li><code>uidvalidity</code>: a value that, together with the <code>uidnext</code> value
    forms a 64 bit number that must be unique for the server</li>
 </ul>
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox The mailbox for which we want to have the status.</xqdoc:param><xqdoc:return>The <code>status</code> of the specified <code>$mailbox</code>. The result is validated against the schema: <code>http://www.zorba-xquery.com/modules/email</code>.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/status_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:status</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function imap:status($host-info as element(email:hostInfo), $mailbox as xs:string) as element(email:status)</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>element(email:status)</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>tokenize</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>status-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:name>imap:status-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:nondeterministic function imap:status-impl($host-info as element(email:hostInfo), $mailbox as xs:string) as xs:string* external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="*">xs:string*</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Creates a new mailbox for the given user.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox-name The name for the new mailbox.</xqdoc:param><xqdoc:return>The function is declared as sequential and has side-effects. It returns the empty sequence.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/create_rename_delete_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:create</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function imap:create($host-info as element(email:hostInfo), $mailbox-name as xs:string) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox-name</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>create-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:name>imap:create-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:sequential function imap:create-impl($host-info as element(email:hostInfo), $mailbox-name as xs:string) as empty-sequence() external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox-name</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Deletes a mailbox for the given user.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox-name The name of the mailbox to delete.</xqdoc:param><xqdoc:return>The function is declared as sequential and has side-effects. It returns the empty sequence.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/create_rename_delete_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:delete</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function imap:delete($host-info as element(email:hostInfo), $mailbox-name as xs:string) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox-name</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>delete-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:name>imap:delete-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:sequential function imap:delete-impl($host-info as element(email:hostInfo), $mailbox-name as xs:string) as empty-sequence() external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox-name</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> Renames a mailbox.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox-old The name of the mailbox we want to rename.</xqdoc:param><xqdoc:param>$mailbox-new The new name for the mailbox.</xqdoc:param><xqdoc:return>The function is declared as sequential and has side-effects. It returns the empty sequence.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/create_rename_delete_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:rename</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function imap:rename($host-info as element(email:hostInfo), $mailbox-old as xs:string, $mailbox-new as xs:string) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox-old</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox-new</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="3"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>rename-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="3"><xqdoc:name>imap:rename-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:sequential function imap:rename-impl($host-info as element(email:hostInfo), $mailbox-old as xs:string, $mailbox-new as xs:string) as empty-sequence() external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox-old</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox-new</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="4"><xqdoc:comment><xqdoc:description> Lists IMAP folders for the specified user on the host that match the pattern.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox-ref is applied to pattern in an implementation dependent fashion to search for matching mailbox names.</xqdoc:param><xqdoc:param>$pattern The pattern for mailboxes to look for (can include wildcards '*' and '%').</xqdoc:param><xqdoc:param>$only-subscribed If set true, only mailboxes are listed to which the user is subscribed.</xqdoc:param><xqdoc:return>A sequence of <code>mailbox</code> elements. The result elements are validated against the schema: <code>http://www.zorba-xquery.com/modules/email</code>.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/list_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:list</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function imap:list($host-info as element(email:hostInfo), $mailbox-ref as xs:string, $pattern as xs:string, $only-subscribed as xs:boolean) as element(email:mailbox)*</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox-ref</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>pattern</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>only-subscribed</xqdoc:name><xqdoc:type>xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="*">element(email:mailbox)*</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>substring-after</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="4"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>list-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="4"><xqdoc:name>imap:list-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:nondeterministic function imap:list-impl($host-info as element(email:hostInfo), $mailbox-ref as xs:string, $pattern as xs:string, $only-subscribed as xs:boolean) as xs:string* external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox-ref</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>pattern</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>only-subscribed</xqdoc:name><xqdoc:type>xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="*">xs:string*</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Subscribes the user to the specified mailbox.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox The mailbox the user wants to subscribe to.</xqdoc:param><xqdoc:return>The function is declared as sequential and has side-effects. It returns the empty sequence.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/subscribe_unsubscribe_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:subscribe</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function imap:subscribe($host-info as element(email:hostInfo), $mailbox as xs:string) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>subscribe-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:name>imap:subscribe-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:sequential function imap:subscribe-impl($host-info as element(email:hostInfo), $mailbox as xs:string) as empty-sequence() external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Unsubscribes the user from the specified mailbox.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox The mailbox the user wants to unsubscribe from.</xqdoc:param><xqdoc:return>The function is declared as sequential and has side-effects. It returns the empty sequence.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/subscribe_unsubscribe_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:unsubscribe</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function imap:unsubscribe($host-info as element(email:hostInfo), $mailbox as xs:string) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>unsubscribe-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:name>imap:unsubscribe-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:sequential function imap:unsubscribe-impl($host-info as element(email:hostInfo), $mailbox as xs:string) as empty-sequence() external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Permanently deletes all messages of the given mailbox that have the "deleted" flag set.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox The mailbox for which all messages that have the \Deleted flag set should be permanently deleted.</xqdoc:param><xqdoc:return>The function is declared as sequential and has side-effects. It returns the empty sequence.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/expunge_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:expunge</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function imap:expunge($host-info as element(email:hostInfo), $mailbox as xs:string) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>expunge-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:name>imap:expunge-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:sequential function imap:expunge-impl($host-info as element(email:hostInfo), $mailbox as xs:string) as empty-sequence() external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="4"><xqdoc:comment><xqdoc:description> Searches a mailbox for messages that match the given criteria.
 The criteria should be a string as defined in the RFC3501 (IMAP4rev1).
 A valid example would be: 'FROM zorba@gmail.com OR NOT SUBJECT Bug'.
 Depending on the value of <code>$uid</code>, the function will either
 return matching sequence numbers or unique identifiers.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox The mailbox to search.</xqdoc:param><xqdoc:param>$criteria The searching criteria.</xqdoc:param><xqdoc:param>$uid If true, the function returns the sequence of unique identifiers corresponding to the matching mails, else the corresponding sequence numbers are returned.</xqdoc:param><xqdoc:return>Either the sequence of matching sequence numbers or the sequence of matching unique identifiers.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/search_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:search</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function imap:search($host-info as element(email:hostInfo), $mailbox as xs:string, $criteria as xs:string, $uid as xs:boolean?) as xs:long*</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>criteria</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>uid</xqdoc:name><xqdoc:type occurrence="?">xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="*">xs:long*</xqdoc:type></xqdoc:return><xqdoc:invoked arity="4"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>search-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="4"><xqdoc:name>imap:search-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:nondeterministic function imap:search-impl($host-info as element(email:hostInfo), $mailbox as xs:string, $criteria as xs:string, $uid as xs:boolean?) as xs:long* external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>criteria</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>uid</xqdoc:name><xqdoc:type occurrence="?">xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="*">xs:long*</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="5"><xqdoc:comment><xqdoc:description> Copies messages between mailboxes.
 Depending on the value of <code>$uid</code>, the messages are either specified
 through their sequence number or through their unique id. Both mailboxes must exist.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox-from The mailbox in which the messages reside.</xqdoc:param><xqdoc:param>$mailbox-to The mailbox in to which the messages are copied.</xqdoc:param><xqdoc:param>$messages The messages to be copied, specified either by their sequence number or their unique id.</xqdoc:param><xqdoc:param>$uid If true, <code>$messages</code> are treated as sequence numbers. Else as unique identifiers.</xqdoc:param><xqdoc:return>The function is declared as sequential and has side-effects. It returns the empty sequence.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>imap:IMAP0003 If no message is found with the provided sequence number/unique identifier.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/copy_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:copy</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function imap:copy($host-info as element(email:hostInfo), $mailbox-from as xs:string, $mailbox-to as xs:string, $messages as xs:long+, $uid as xs:boolean?) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox-from</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox-to</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>messages</xqdoc:name><xqdoc:type occurrence="+">xs:long</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>uid</xqdoc:name><xqdoc:type occurrence="?">xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>true</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="6"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>copy-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="6"><xqdoc:name>imap:copy-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:sequential function imap:copy-impl($host-info as element(email:hostInfo), $mailbox-from as xs:string, $mailbox-to as xs:string, $messages as xs:long+, $uid as xs:boolean?, $copy as xs:boolean) as empty-sequence() external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox-from</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox-to</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>messages</xqdoc:name><xqdoc:type occurrence="+">xs:long</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>uid</xqdoc:name><xqdoc:type occurrence="?">xs:boolean</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>copy</xqdoc:name><xqdoc:type>xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="5"><xqdoc:comment><xqdoc:description> Moves messages between mailboxes.
 Depending on the value of <code>$uid</code>, the messages are either specified through
 their sequence number or through their unique id. Both mailboxes must exist.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox-from The mailbox in which the messages reside.</xqdoc:param><xqdoc:param>$mailbox-to The mailbox in to which the messages should be moved.</xqdoc:param><xqdoc:param>$messages The messages to be copied, specified either by their sequence number or their unique id.</xqdoc:param><xqdoc:param>$uid If true, <code>$messages</code> are treated as sequence numbers. Else as unique identifiers.</xqdoc:param><xqdoc:return>The function is declared as sequential and has side-effects. It returns the empty sequence.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>imap:IMAP0003 If no message is found with the provided sequence number/unique identifier.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/move_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:move</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function imap:move($host-info as element(email:hostInfo), $mailbox-from as xs:string, $mailbox-to as xs:string, $messages as xs:long+, $uid as xs:boolean?) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox-from</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox-to</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>messages</xqdoc:name><xqdoc:type occurrence="+">xs:long</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>uid</xqdoc:name><xqdoc:type occurrence="?">xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>false</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="6"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>copy-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="4"><xqdoc:comment><xqdoc:description> Fetches the envelope of a message.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox The mailbox in which to search for the message.</xqdoc:param><xqdoc:param>$message-number The message for which to fetch the envelope (depending on <code>$uid</code> either as message sequence number or unique identifier).</xqdoc:param><xqdoc:param>$uid If true, <code>$message-number</code> is treated as sequence number. Else as unique identifier.</xqdoc:param><xqdoc:return>The <code>envelope</code> of the requested message. The result is validated against the schema: <code>http://www.zorba-xquery.com/modules/email</code>.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>imap:IMAP0003 If no message is found with the provided sequence number/unique identifier.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/fetch_envelope_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:fetch-envelope</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function imap:fetch-envelope($host-info as element(email:hostInfo), $mailbox as xs:string, $message-number as xs:long, $uid as xs:boolean?) as element(email:envelope)</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>message-number</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>uid</xqdoc:name><xqdoc:type occurrence="?">xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>element(email:envelope)</xqdoc:type></xqdoc:return><xqdoc:invoked arity="4"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>fetch-envelope-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="4"><xqdoc:name>imap:fetch-envelope-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:nondeterministic function imap:fetch-envelope-impl($host-info as element(email:hostInfo), $mailbox as xs:string, $message-number as xs:long, $uid as xs:boolean?) as element(email:envelope) external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>message-number</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>uid</xqdoc:name><xqdoc:type occurrence="?">xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>element(email:envelope)</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="4"><xqdoc:comment><xqdoc:description> Fetches a whole message.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox The mailbox in which to search for the message.</xqdoc:param><xqdoc:param>$message-number The message to fetch, denoted either by its sequence number or unique identifier.</xqdoc:param><xqdoc:param>$uid If true, <code>$message-number</code> is treated as sequence number. Else as unique identifier.</xqdoc:param><xqdoc:return>the <code>message</code> with the given <code>$message-number</code>. The result is validated against the schema: <code>http://www.zorba-xquery.com/modules/email</code>.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>imap:IMAP0003 If no message is found with the provided sequence number/unique identifier.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/fetch_message_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:fetch-message</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function imap:fetch-message($host-info as element(email:hostInfo), $mailbox as xs:string, $message-number as xs:long, $uid as xs:boolean) as element(email:message)</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>message-number</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>uid</xqdoc:name><xqdoc:type>xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>element(email:message)</xqdoc:type></xqdoc:return><xqdoc:invoked arity="4"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>fetch-message-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="4"><xqdoc:name>imap:fetch-message-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:nondeterministic function imap:fetch-message-impl($host-info as element(email:hostInfo), $mailbox as xs:string, $message-number as xs:long, $uid as xs:boolean) as element(*) external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>message-number</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>uid</xqdoc:name><xqdoc:type>xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>element(*)</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> Fetches the subject for a message.
 Please note that this function only works with message sequence numbers,
 not with unique identifiers. Only the first 255 characters of a subject
 are fetched.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox The mailbox for which we want to get the subject of a message.</xqdoc:param><xqdoc:param>$message-number Denotes the message for which we want the subject.</xqdoc:param><xqdoc:return>The subject of the specified message.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>imap:IMAP0003 If no message is found with the provided sequence number/unique identifier.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/fetch_subject_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:fetch-subject</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function imap:fetch-subject($host-info as element(email:hostInfo), $mailbox as xs:string, $message-number as xs:long) as xs:string</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>message-number</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:string</xqdoc:type></xqdoc:return><xqdoc:invoked arity="3"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>fetch-subject-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="3"><xqdoc:name>imap:fetch-subject-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:nondeterministic function imap:fetch-subject-impl($host-info as element(email:hostInfo), $mailbox as xs:string, $message-number as xs:long) as xs:string external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>message-number</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:string</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> Fetches the 'from' string of a message.
 Please note that this function only words with message sequence numbers,
 not with unique identifiers. Only the first 255 characters of a 'from'
 string are fetched.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox The mailbox for which we want to get the 'from' string of a message.</xqdoc:param><xqdoc:param>$message-number Denotes the message for which we want the 'from' string.</xqdoc:param><xqdoc:return>The 'from' string of the specified message.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>imap:IMAP0003 If no message is found with the provided sequence number/unique identifier.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/fetch_from_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:fetch-from</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function imap:fetch-from($host-info as element(email:hostInfo), $mailbox as xs:string, $message-number as xs:long) as xs:string</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>message-number</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:string</xqdoc:type></xqdoc:return><xqdoc:invoked arity="3"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>fetch-from-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="3"><xqdoc:name>imap:fetch-from-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:nondeterministic function imap:fetch-from-impl($host-info as element(email:hostInfo), $mailbox as xs:string, $message-number as xs:long) as xs:string external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>message-number</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:string</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> Fetches the unique identifier for a given message sequence number.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox The mailbox for which we want to get the unique identifier of a message sequence number.</xqdoc:param><xqdoc:param>$message-number The message sequence number for which we want the unique identifier.</xqdoc:param><xqdoc:return>The unique identifier of the given message sequence number.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>imap:IMAP0003 If no message is found with the provided sequence number/unique identifier.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/fetch_uid_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:fetch-uid</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function imap:fetch-uid($host-info as element(email:hostInfo), $mailbox as xs:string, $message-number as xs:long) as xs:long</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>message-number</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:long</xqdoc:type></xqdoc:return><xqdoc:invoked arity="3"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>fetch-uid-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="3"><xqdoc:name>imap:fetch-uid-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:nondeterministic function imap:fetch-uid-impl($host-info as element(email:hostInfo), $mailbox as xs:string, $message-number as xs:long) as xs:long external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>message-number</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:long</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> Fetches the message sequence number for a given unique identifier.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox The mailbox for which we want to get the message sequence number of an unique identifier.</xqdoc:param><xqdoc:param>$message-number The unique identifier for which we want the message sequence number.</xqdoc:param><xqdoc:return>The message sequence number of the of the given unique identifier.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>imap:IMAP0003 If no message is found with the provided sequence number/unique identifier.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/fetch_message_sequence_number_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:fetch-message-sequence-number</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function imap:fetch-message-sequence-number($host-info as element(email:hostInfo), $mailbox as xs:string, $message-number as xs:long) as xs:long</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>message-number</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:long</xqdoc:type></xqdoc:return><xqdoc:invoked arity="3"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>fetch-message-sequence-number-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="3"><xqdoc:name>imap:fetch-message-sequence-number-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:nondeterministic function imap:fetch-message-sequence-number-impl($host-info as element(email:hostInfo), $mailbox as xs:string, $message-number as xs:long) as xs:long external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>message-number</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:long</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="4"><xqdoc:comment><xqdoc:description> Fetches the flags of a message.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox The mailbox containing the specified message.</xqdoc:param><xqdoc:param>$message-number Either the message sequence number or the unique identifier of the message.</xqdoc:param><xqdoc:param>$uid If true, <code>$message-number</code> is treated as sequence number. Else as unique identifier.</xqdoc:param><xqdoc:return>The <code>flags</code> of the specified message. The result is validated against the schema: <code>http://www.zorba-xquery.com/modules/email</code>.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>imap:IMAP0003 If no message is found with the provided sequence number/unique identifier.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/fetch_flags_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:fetch-flags</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function imap:fetch-flags($host-info as element(email:hostInfo), $mailbox as xs:string, $message-number as xs:long, $uid as xs:boolean?) as element(email:flags)</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>message-number</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>uid</xqdoc:name><xqdoc:type occurrence="?">xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>element(email:flags)</xqdoc:type></xqdoc:return><xqdoc:invoked arity="4"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>fetch-flags-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="4"><xqdoc:name>imap:fetch-flags-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:nondeterministic function imap:fetch-flags-impl($host-info as element(email:hostInfo), $mailbox as xs:string, $message-number as xs:long, $uid as xs:boolean?) as element(email:flags) external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>message-number</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>uid</xqdoc:name><xqdoc:type occurrence="?">xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>element(email:flags)</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="5"><xqdoc:comment><xqdoc:description> Sets the flags for a given message.
 The flags are set and unset according to the passed <code>$flags</code>.
</xqdoc:description><xqdoc:param>$host-info The IMAP host, user name, and password.</xqdoc:param><xqdoc:param>$mailbox The mailbox containing the specified message.</xqdoc:param><xqdoc:param>$message-number Either the message sequence number or the unique identifier of the message (depending on the value of <code>$uid</code>).</xqdoc:param><xqdoc:param>$flags Defines which flags should be set for this message. The possibilities are "seen", "deleted", "flagged", "answered", and "draft". Setting all flags at once is done by passing the element: <code> &lt;email:flags&gt; &lt;email:seen/&gt; &lt;email:deleted/&gt; &lt;email:flagged/&gt; &lt;email:answered/&gt; &lt;email:draft/&gt; &lt;/email:flags&gt; </code>. Setting "flagged" only and unsetting all other at once can be done by passing: <code> &lt;email:flags&gt; &lt;email:flagged/&gt; &lt;/email:flags&gt; </code>.</xqdoc:param><xqdoc:param>$uid If true, <code>$message-number</code> is treated as sequence number. Else as unique identifier.</xqdoc:param><xqdoc:return>The function is declared as sequential and has side-effects. It returns the empty sequence.</xqdoc:return><xqdoc:error>imap:IMAP0001 If the IMAP operation failed.</xqdoc:error><xqdoc:error>imap:IMAP0002 If the connection to the IMAP server is refused.</xqdoc:error><xqdoc:error>imap:IMAP0003 If no message is found with the provided sequence number/unique identifier.</xqdoc:error><xqdoc:error>err:XQDY0027 If the value of <code>$host-info</code> is not valid according to the email schema: <code>http://www.zorba-xquery.com/modules/email</code></xqdoc:error><xqdoc:custom tag="example">examples/Queries/imap/set_flags_example.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>imap:set-flags</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function imap:set-flags($host-info as element(email:hostInfo), $mailbox as xs:string, $message-number as xs:long, $flags as element(email:flags), $uid as xs:boolean?) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>message-number</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>flags</xqdoc:name><xqdoc:type>element(email:flags)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>uid</xqdoc:name><xqdoc:type occurrence="?">xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="5"><xqdoc:uri>http://www.zorba-xquery.com/modules/email/imap</xqdoc:uri><xqdoc:name>set-flags-impl</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="5"><xqdoc:name>imap:set-flags-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:sequential function imap:set-flags-impl($host-info as element(email:hostInfo), $mailbox as xs:string, $message-number as xs:long, $flags as element(email:flags), $uid as xs:boolean?) as empty-sequence() external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>host-info</xqdoc:name><xqdoc:type>element(email:hostInfo)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>mailbox</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>message-number</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>flags</xqdoc:name><xqdoc:type>element(email:flags)</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>uid</xqdoc:name><xqdoc:type occurrence="?">xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return></xqdoc:function></xqdoc:functions></xqdoc:xqdoc>