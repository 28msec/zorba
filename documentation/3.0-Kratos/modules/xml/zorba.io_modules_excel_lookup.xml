<xqdoc:xqdoc xmlns:xqdoc="http://www.xqdoc.org/1.0"><xqdoc:control><xqdoc:date>2013-12-04T01:28:38.942159+01:00</xqdoc:date><xqdoc:version>1.0</xqdoc:version></xqdoc:control><xqdoc:module type="library"><xqdoc:uri>http://zorba.io/modules/excel/lookup</xqdoc:uri><xqdoc:name>lookup</xqdoc:name><xqdoc:comment><xqdoc:description> This module implements some Excel 2003 lookup functions.
</xqdoc:description><xqdoc:author>Daniel Turcanu</xqdoc:author><xqdoc:see><a href="http://office.microsoft.com/en-us/excel/CH062528281033.aspx" target="_blank">Excel 2003 Documentation: Lookup Functions</a></xqdoc:see><xqdoc:custom tag="project">Zorba/Excel/Lookup</xqdoc:custom><xqdoc:custom tag="language">xquery</xqdoc:custom><xqdoc:custom tag="version">3.0</xqdoc:custom><xqdoc:custom tag="encoding">utf-8</xqdoc:custom></xqdoc:comment><xqdoc:custom tag="namespaces"><xqdoc:namespace prefix="excel" uri="http://zorba.io/modules/excel/lookup" isSchema="false"/><xqdoc:namespace prefix="excel-err" uri="http://zorba.io/modules/excel/errors" isSchema="false"/><xqdoc:namespace prefix="excel-math" uri="http://zorba.io/modules/excel/math" isSchema="false"/><xqdoc:namespace prefix="ver" uri="http://zorba.io/options/versioning" isSchema="false"/></xqdoc:custom></xqdoc:module><xqdoc:imports><xqdoc:import type="library"><xqdoc:uri>http://zorba.io/modules/excel/math</xqdoc:uri><xqdoc:comment><xqdoc:description> Use excel-math module functions.
</xqdoc:description></xqdoc:comment></xqdoc:import></xqdoc:imports><xqdoc:variables/><xqdoc:collections/><xqdoc:indexes/><xqdoc:functions><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Uses index_num to return a value from the sequence of value arguments.
</xqdoc:description><xqdoc:param>$index_num The position in the sequence, 1 based.</xqdoc:param><xqdoc:param>$values The sequence of values.</xqdoc:param><xqdoc:return>The value at the index position.</xqdoc:return><xqdoc:error>excel-err:Value if index is smaller than 1 or bigger than the size of sequence.</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052090131033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/lookup/choose1.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:choose</xqdoc:name><xqdoc:signature>declare function excel:choose($index_num as xs:integer, $values as xs:anyAtomicType*) as xs:anyAtomicType</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>index_num</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>values</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>count</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="30"><xqdoc:comment><xqdoc:description> Uses index_num to return a sequence from the list of sequences.
 Use CHOOSE to select one of up to 29 sequences based on the index number.
</xqdoc:description><xqdoc:param>$index_num the position in the sequence, 1 based</xqdoc:param><xqdoc:param>$value_sequence1 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence2 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence3 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence4 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence5 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence6 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence7 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence8 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence9 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence10 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence11 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence12 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence13 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence14 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence15 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence16 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence17 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence18 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence19 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence20 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence21 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence22 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence23 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence24 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence25 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence26 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence27 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence28 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:param>$value_sequence29 a sequence of values. Specify the empty sequence () if you don't need it.</xqdoc:param><xqdoc:return>The value at the index position</xqdoc:return><xqdoc:error>excel-err:Value if index is smaller than 1 or bigger than 29</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052090131033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/lookup/choose2.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:choose</xqdoc:name><xqdoc:signature>declare function excel:choose($index_num as xs:integer, $value_sequence1 as xs:anyAtomicType*, $value_sequence2 as xs:anyAtomicType*, $value_sequence3 as xs:anyAtomicType*, $value_sequence4 as xs:anyAtomicType*, $value_sequence5 as xs:anyAtomicType*, $value_sequence6 as xs:anyAtomicType*, $value_sequence7 as xs:anyAtomicType*, $value_sequence8 as xs:anyAtomicType*, $value_sequence9 as xs:anyAtomicType*, $value_sequence10 as xs:anyAtomicType*, $value_sequence11 as xs:anyAtomicType*, $value_sequence12 as xs:anyAtomicType*, $value_sequence13 as xs:anyAtomicType*, $value_sequence14 as xs:anyAtomicType*, $value_sequence15 as xs:anyAtomicType*, $value_sequence16 as xs:anyAtomicType*, $value_sequence17 as xs:anyAtomicType*, $value_sequence18 as xs:anyAtomicType*, $value_sequence19 as xs:anyAtomicType*, $value_sequence20 as xs:anyAtomicType*, $value_sequence21 as xs:anyAtomicType*, $value_sequence22 as xs:anyAtomicType*, $value_sequence23 as xs:anyAtomicType*, $value_sequence24 as xs:anyAtomicType*, $value_sequence25 as xs:anyAtomicType*, $value_sequence26 as xs:anyAtomicType*, $value_sequence27 as xs:anyAtomicType*, $value_sequence28 as xs:anyAtomicType*, $value_sequence29 as xs:anyAtomicType*) as xs:anyAtomicType*</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>index_num</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence1</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence2</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence3</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence4</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence5</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence6</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence7</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence8</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence9</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence10</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence11</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence12</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence13</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence14</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence15</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence16</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence17</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence18</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence19</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence20</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence21</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence22</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence23</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence24</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence25</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence26</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence27</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence28</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value_sequence29</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="*">xs:anyAtomicType*</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="5"><xqdoc:comment><xqdoc:description> Function for HLOOKUP, LOOKUP, MATCH, VLOOKUP.
 This function should not be used outside this module.
 It searches a lookup_value in table_header with three different algorithms
 specified by range_lookup.
</xqdoc:description><xqdoc:param>$lookup_value the value to be searched. Allowed types are numeric, string, boolean. Boolean values are compared only with booleans. Numbers are compared only with numbers, if range_lookup is not zero. The other types are converted to string and compared to string value of all values.</xqdoc:param><xqdoc:param>$table_header the sequence of values where to search</xqdoc:param><xqdoc:param>$range_lookup specified the algorithm for searching. Can have values: 1 = finds the largest value that is less than or equal to lookup_value. Table_header must be in ascending order. 0 = finds the first value that is exactly equal to lookup_value. Table_header can be in any order. If lookup_value is boolean, then only booleans are compared. For other types, they are casted to string and then compared using xquery regular expressions. Lookup_value can be a xquery regular expression. -1 = finds the smallest value that is greater than or equal to lookup_value. Table_header must be in descending order.</xqdoc:param><xqdoc:param>$pos the current position in original table_header</xqdoc:param><xqdoc:param>$last_comparable_pos the position of last value that might be a match</xqdoc:param><xqdoc:return>the value found</xqdoc:return><xqdoc:error>excel-err:Value if range_lookup=0 and the value cannot be found</xqdoc:error></xqdoc:comment><xqdoc:name>excel:lookup-column</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function excel:lookup-column($lookup_value as xs:anyAtomicType, $table_header as xs:anyAtomicType*, $range_lookup as xs:integer, $pos as xs:integer, $last_comparable_pos as xs:integer) as xs:integer</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>lookup_value</xqdoc:name><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>table_header</xqdoc:name><xqdoc:type occurrence="*">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>range_lookup</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>pos</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>last_comparable_pos</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:integer</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>compare</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>empty</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>matches</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>string</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>subsequence</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>upper-case</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="5"><xqdoc:uri>http://zorba.io/modules/excel/lookup</xqdoc:uri><xqdoc:name>lookup-column</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/math</xqdoc:uri><xqdoc:name>cast-as-numeric</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/excel/math</xqdoc:uri><xqdoc:name>is-a-number</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="6"><xqdoc:comment><xqdoc:description> Searches for a value in the top row of an array of values,
   and then returns a value in the same column from a row you specify in the array.
 <dl>Array is specified with 3 parameters:
 <dt>table_array</dt> <dd>is a sequence of elements, first row first, then second row and so on</dd>
 <dt>table_width</dt> <dd>specifies the number of elements in a row</dd>
 <dt>table_height</dt> <dd>specifies the number of rows</dd></dl>
 The number of elements in table_array must be equal or more than table_width * table_height.<p/>
 For wildchar matching, the XQuery regex matcher is used.
</xqdoc:description><xqdoc:param>$lookup_value the value to be searched. Allowed types are numeric, string, boolean. <p/> Boolean values are compared only with booleans. Numbers are compared only with numbers, if range_lookup is not zero. The other types are converted to string and compared to string value of all values.</xqdoc:param><xqdoc:param>$table_array the sequence of values, row after row</xqdoc:param><xqdoc:param>$table_width the number of values in a row</xqdoc:param><xqdoc:param>$table_height the number of rows</xqdoc:param><xqdoc:param>$row_index_num the row index, 1 based</xqdoc:param><xqdoc:param>$range_lookup <dl>specifies the algorithm to use: <dt>true</dt> <dd>find approximative match. First row of array must be sorted in ascending order.</dd> <dt>false</dt> <dd>find exact match, using xquery regex First row of array can be in any order. </dd></dl></xqdoc:param><xqdoc:return>The value found, with original type</xqdoc:return><xqdoc:error>excel-err:Value if the array contains less elements than specified by table_height and table_width</xqdoc:error><xqdoc:error>excel-err:Value if row_index_num is outside the range 1 .. table_height</xqdoc:error><xqdoc:error>excel-err:Value if range_lookup is true and the value searched is smaller than the first value in the header</xqdoc:error><xqdoc:error>excel-err:Value if range_lookup=false and the value cannot be found</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052091141033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/lookup/hlookup1.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/hlookup2.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/hlookup3.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/hlookup4.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/hlookup5.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:hlookup</xqdoc:name><xqdoc:signature>declare function excel:hlookup($lookup_value as xs:anyAtomicType, $table_array as xs:anyAtomicType+, $table_width as xs:integer, $table_height as xs:integer, $row_index_num as xs:integer, $range_lookup as xs:boolean) as xs:anyAtomicType</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>lookup_value</xqdoc:name><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>table_array</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>table_width</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>table_height</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>row_index_num</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>range_lookup</xqdoc:name><xqdoc:type>xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>count</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="5"><xqdoc:uri>http://zorba.io/modules/excel/lookup</xqdoc:uri><xqdoc:name>lookup-column</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="5"><xqdoc:comment><xqdoc:description> Same as above, only that range_lookup is defaulted to true.
 That is, this Hlookup looks for the approximate value
   and the first row must be ordered ascending.
</xqdoc:description><xqdoc:param>$lookup_value the value to be searched. Allowed types are numeric, string, boolean. <p/> Boolean values are compared only with booleans. Numbers are compared only with numbers, if range_lookup is not zero. The other types are converted to string and compared to string value of all values.</xqdoc:param><xqdoc:param>$table_array the sequence of values, row after row</xqdoc:param><xqdoc:param>$table_width the number of values in a row</xqdoc:param><xqdoc:param>$table_height the number of rows</xqdoc:param><xqdoc:param>$row_index_num the row index, 1 based</xqdoc:param><xqdoc:return>The value found, with original type</xqdoc:return><xqdoc:error>excel-err:Value if the array contains less elements than specified by table_height and table_width</xqdoc:error><xqdoc:error>excel-err:Value if row_index_num is outside the range 1 .. table_height</xqdoc:error><xqdoc:error>excel-err:Value if range_lookup is true and the value searched is smaller than the first value in the header</xqdoc:error><xqdoc:error>excel-err:Value if range_lookup=false and the value cannot be found</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052091141033.aspx</xqdoc:see></xqdoc:comment><xqdoc:name>excel:hlookup</xqdoc:name><xqdoc:signature>declare function excel:hlookup($lookup_value as xs:anyAtomicType, $table_array as xs:anyAtomicType+, $table_width as xs:integer, $table_height as xs:integer, $row_index_num as xs:integer) as xs:anyAtomicType</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>lookup_value</xqdoc:name><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>table_array</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>table_width</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>table_height</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>row_index_num</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>true</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="6"><xqdoc:uri>http://zorba.io/modules/excel/lookup</xqdoc:uri><xqdoc:name>hlookup</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="5"><xqdoc:comment><xqdoc:description> Returns a value from within an array.<p/>
 This is the Array form of the Excel Index function.<p/>
 <dl>Array is specified with 3 parameters:
 <dt>array</dt> <dd>is a sequence of elements, first row first, then second row and so on</dd>
 <dt>array_height</dt> <dd>specifies the number of rows</dd>
 <dt>array_width</dt> <dd>specifies the number of elements in a row</dd></dl>
 The number of elements in array must be equal or more than array_width * array_height.
</xqdoc:description><xqdoc:param>$array the sequence of values, row after row</xqdoc:param><xqdoc:param>$array_width the number of values in a row</xqdoc:param><xqdoc:param>$array_height the number of rows</xqdoc:param><xqdoc:param>$row_num the row position of the value, 1 based</xqdoc:param><xqdoc:param>$column_num the column position of the value, 1 based</xqdoc:param><xqdoc:return>The value from x-y in the array</xqdoc:return><xqdoc:error>excel-err:Value if the array contains less elements than specified by table_height and table_width</xqdoc:error><xqdoc:error>excel-err:Ref if row_num is outside the range</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052091381033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/lookup/index1.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/index2.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/index3.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/index4.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/index5.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:index</xqdoc:name><xqdoc:signature>declare function excel:index($array as xs:anyAtomicType+, $array_height as xs:integer, $array_width as xs:integer, $row_num as xs:integer, $column_num as xs:integer) as xs:anyAtomicType+</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>array</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>array_height</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>array_width</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>row_num</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>column_num</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="+">xs:anyAtomicType+</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>count</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> The Vector form. <p/>
 Looks in a sequence for a value
   and return a value from the same position in a second sequence.
 If the value is not found, then it matches the largest value in lookup_vector
   that is less than or equal to lookup_value.
</xqdoc:description><xqdoc:param>$lookup_value the value to be searched</xqdoc:param><xqdoc:param>$lookup_vector the sequence to be searched, in ascending order.</xqdoc:param><xqdoc:param>$result_vector the sequence containing the result values</xqdoc:param><xqdoc:return>a value from $result_vector</xqdoc:return><xqdoc:error>excel-err:NA if lookup value is smaller than the first value in lookup_vector</xqdoc:error><xqdoc:error>excel-err:NA if position found is outside the result range</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052091631033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/lookup/lookup1.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/lookup2.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/lookup3.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/lookup4.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:lookup</xqdoc:name><xqdoc:signature>declare function excel:lookup($lookup_value as xs:anyAtomicType, $lookup_vector as xs:anyAtomicType+, $result_vector as xs:anyAtomicType+) as xs:anyAtomicType</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>lookup_value</xqdoc:name><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>lookup_vector</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>result_vector</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>count</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="5"><xqdoc:uri>http://zorba.io/modules/excel/lookup</xqdoc:uri><xqdoc:name>lookup-column</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="4"><xqdoc:comment><xqdoc:description> The Array form.<p/>
 It looks in the first row or column of an array for the specified value
   and returns a value from the same position in the last row or column of the array.<p/>
 If array covers an area that is wider than it is tall (more columns than rows),
   LOOKUP searches for lookup_value in the first row.<p/>
 If array is square or is taller than it is wide (more rows than columns),
   LOOKUP searches in the first column.<p/>
 The values in the first row or first column must be in ascending order.
</xqdoc:description><xqdoc:param>$lookup_value the value to be searched. If the value is not found, then it matches the largest value in lookup_vector that is less than or equal to lookup_value.</xqdoc:param><xqdoc:param>$array the array sequence, row after row</xqdoc:param><xqdoc:param>$array_width the number of values in a row</xqdoc:param><xqdoc:param>$array_height the number of rows in the array</xqdoc:param><xqdoc:return>The corresponding value in the last row or column</xqdoc:return><xqdoc:error>excel-err:Value if array contains less values than specified by array_width and array_height or array_width = 0 or array_height = 0</xqdoc:error><xqdoc:error>excel-err:NA if the lookup_value is smaller than the first value in the row or column</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052091631033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/lookup/lookup5.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/lookup6.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/lookup7.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:lookup</xqdoc:name><xqdoc:signature>declare function excel:lookup($lookup_value as xs:anyAtomicType, $array as xs:anyAtomicType+, $array_width as xs:integer, $array_height as xs:integer) as xs:anyAtomicType</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>lookup_value</xqdoc:name><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>array</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>array_width</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>array_height</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>count</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="5"><xqdoc:uri>http://zorba.io/modules/excel/lookup</xqdoc:uri><xqdoc:name>lookup-column</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> Returns the relative position of an item in a sequence that
   matches a specified value in a specified order.
 Only for one dimensional vector.
</xqdoc:description><xqdoc:param>$lookup_value value to be searched.</xqdoc:param><xqdoc:param>$sequence the vector where to search the value</xqdoc:param><xqdoc:param>$match_type <dl>specifies the algorithm used for searching. Possible values: <dt>1</dt> <dd> finds the largest value that is less than or equal to lookup_value. Sequence must be in ascending order.</dd> <dt>0</dt> <dd> finds the first value that is exactly equal to lookup_value. <p/> Sequence can be in any order.<p/> If lookup_value is boolean, then only booleans are compared.<p/> For other types, they are casted to string and then compared using xquery regular expressions. Lookup_value can be a xquery regular expression.</dd> <dt>-1</dt> <dd> finds the smallest value that is greater than or equal to lookup_value.<p/> Sequence must be in descending order.</dd></dl></xqdoc:param><xqdoc:return>The position of found value</xqdoc:return><xqdoc:error>excel-err:NA for match_type 1 or -1, the lookup_value is smaller or larger than the first value in sequence</xqdoc:error><xqdoc:error>excel-err:Value if range_lookup=0 and the value cannot be found</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052091681033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/lookup/match2.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/match3.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:match</xqdoc:name><xqdoc:signature>declare function excel:match($lookup_value as xs:anyAtomicType, $sequence as xs:anyAtomicType+, $match_type as xs:integer) as xs:anyAtomicType</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>lookup_value</xqdoc:name><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>sequence</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>match_type</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="5"><xqdoc:uri>http://zorba.io/modules/excel/lookup</xqdoc:uri><xqdoc:name>lookup-column</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Same as above, but match_type is defaulted to 1.
 It finds the largest value that is less than or equal to lookup_value.
</xqdoc:description><xqdoc:param>$lookup_value value to be searched.</xqdoc:param><xqdoc:param>$sequence the vector where to search the value</xqdoc:param><xqdoc:return>The position of found value</xqdoc:return><xqdoc:error>excel-err:NA for match_type 1 or -1, the lookup_value is smaller or larger than the first value in sequence</xqdoc:error><xqdoc:error>excel-err:Value if range_lookup=0 and the value cannot be found</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052091681033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/lookup/match1.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:match</xqdoc:name><xqdoc:signature>declare function excel:match($lookup_value as xs:anyAtomicType, $sequence as xs:anyAtomicType+) as xs:anyAtomicType</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>lookup_value</xqdoc:name><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>sequence</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:return><xqdoc:invoked arity="3"><xqdoc:uri>http://zorba.io/modules/excel/lookup</xqdoc:uri><xqdoc:name>match</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="7"><xqdoc:comment><xqdoc:description> Returns a sub-array from an array.
 The inner array must be within the reference array
</xqdoc:description><xqdoc:param>$reference the reference array</xqdoc:param><xqdoc:param>$reference_height the number of rows in the reference array</xqdoc:param><xqdoc:param>$reference_width the number of elements in the reference array row</xqdoc:param><xqdoc:param>$rows the relative row position where the sub-array starts. It must be a positive value, zero relative.</xqdoc:param><xqdoc:param>$cols the relative column position where the sub-array starts. It must be a positive value, zero relative.</xqdoc:param><xqdoc:param>$height the desired height of sub-array. The sub-array must be inside the reference array.</xqdoc:param><xqdoc:param>$width the desired width of sub-array. The sub-array must be inside the reference array.</xqdoc:param><xqdoc:return>The sequence specifying the sub-array, row after row</xqdoc:return><xqdoc:error>excel-err:NA rows or cols are negative</xqdoc:error><xqdoc:error>excel-err:NA height or width are smaller than 1</xqdoc:error><xqdoc:error>excel-err:Value reference array contains less elements than specified by reference_height and reference_width</xqdoc:error><xqdoc:error>excel-err:NA the resulted sub-array is not completely contained inside reference array</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052092081033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/lookup/offset3.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/offset4.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:offset</xqdoc:name><xqdoc:signature>declare function excel:offset($reference as xs:anyAtomicType+, $reference_height as xs:integer, $reference_width as xs:integer, $rows as xs:integer, $cols as xs:integer, $height as xs:integer, $width as xs:integer) as xs:anyAtomicType*</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>reference</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>reference_height</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>reference_width</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>rows</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>cols</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>height</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>width</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="*">xs:anyAtomicType*</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>count</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="5"><xqdoc:comment><xqdoc:description> Same as above, only that the sub-array is specified only by rows and cols relative position.
 The sub-array height and width is computed to contain the remaining elements of the array.
</xqdoc:description><xqdoc:param>$reference the reference array</xqdoc:param><xqdoc:param>$reference_height the number of rows in the reference array</xqdoc:param><xqdoc:param>$reference_width the number of elements in the reference array row</xqdoc:param><xqdoc:param>$rows the relative row position where the sub-array starts. It must be a positive value, zero relative.</xqdoc:param><xqdoc:param>$cols the relative column position where the sub-array starts. It must be a positive value, zero relative.</xqdoc:param><xqdoc:return>The sequence specifying the sub-array, row after row</xqdoc:return><xqdoc:error>excel-err:NA rows or cols are negative</xqdoc:error><xqdoc:error>excel-err:NA height or width are smaller than 1</xqdoc:error><xqdoc:error>excel-err:Value reference array contains less elements than specified by reference_height and reference_width</xqdoc:error><xqdoc:error>excel-err:NA the resulted sub-array is not completely contained inside reference array</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052092081033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/lookup/offset1.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/offset2.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:offset</xqdoc:name><xqdoc:signature>declare function excel:offset($reference as xs:anyAtomicType+, $reference_height as xs:integer, $reference_width as xs:integer, $rows as xs:integer, $cols as xs:integer) as xs:anyAtomicType*</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>reference</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>reference_height</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>reference_width</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>rows</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>cols</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="*">xs:anyAtomicType*</xqdoc:type></xqdoc:return><xqdoc:invoked arity="7"><xqdoc:uri>http://zorba.io/modules/excel/lookup</xqdoc:uri><xqdoc:name>offset</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> Transposes an array. The rows become columns and vice versa.
</xqdoc:description><xqdoc:param>$array the sequence specifying the array, row after row</xqdoc:param><xqdoc:param>$array_width the number of elements in a row</xqdoc:param><xqdoc:param>$array_height the number of rows in the array</xqdoc:param><xqdoc:return>The transposed array. It will be a sequence specifying an array, row after row. The result width is the input height. The result height is the input width.</xqdoc:return><xqdoc:error>excel-err:Value the array contains less elements than specified by array_width and array_height</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052093191033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/lookup/transpose1.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/transpose2.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:transpose</xqdoc:name><xqdoc:signature>declare function excel:transpose($array as xs:anyAtomicType+, $array_width as xs:integer, $array_height as xs:integer) as xs:anyAtomicType+</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>array</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>array_width</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>array_height</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="+">xs:anyAtomicType+</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>count</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="6"><xqdoc:comment><xqdoc:description> Searches for a value in the first column of a table array
   and returns a value in the same row from another column in the table array.
 <dl>Array is specified with 3 parameters:
 <dt>table_array</dt> <dd>is a sequence of elements, first row first, then second row and so on</dd>
 <dt>table_width</dt> <dd>specifies the number of elements in a row</dd>
 <dt>table_height</dt> <dd>specifies the number of rows</dd></dl>
 For wildchar matching, the XQuery regex matcher is used.
</xqdoc:description><xqdoc:param>$lookup_value the value to be searched. Allowed types are numeric, string, boolean. <p/> Boolean values are compared only with booleans. Numbers are compared only with numbers, if range_lookup is not zero. The other types are converted to string and compared to string value of all values.</xqdoc:param><xqdoc:param>$table_array the sequence of values, row after row</xqdoc:param><xqdoc:param>$table_width the number of values in a row</xqdoc:param><xqdoc:param>$table_height the number of rows</xqdoc:param><xqdoc:param>$col_index_num the row index, 1 based</xqdoc:param><xqdoc:param>$range_lookup <dl>specified the algorithm to use: <dt>true</dt> <dd> find approximative match. First column of array must be sorted in ascending order.</dd> <dt>false</dt> <dd> find exact match, using xquery regex. First column of array can be in any order.</dd></dl></xqdoc:param><xqdoc:return>The value found, with original type</xqdoc:return><xqdoc:error>excel-err:Value if the array contains less elements than specified by table_height and table_width</xqdoc:error><xqdoc:error>excel-err:Value if col_index_num is outside the range 1 .. table_height</xqdoc:error><xqdoc:error>excel-err:Value if range_lookup is true and the value searched is smaller than the first value in the first column</xqdoc:error><xqdoc:error>excel-err:Value if range_lookup=false and the value cannot be found</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052093351033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/lookup/vlookup4.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:vlookup</xqdoc:name><xqdoc:signature>declare function excel:vlookup($lookup_value as xs:anyAtomicType, $table_array as xs:anyAtomicType+, $table_width as xs:integer, $table_height as xs:integer, $col_index_num as xs:integer, $range_lookup as xs:boolean) as xs:anyAtomicType</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>lookup_value</xqdoc:name><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>table_array</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>table_width</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>table_height</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>col_index_num</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>range_lookup</xqdoc:name><xqdoc:type>xs:boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>count</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="5"><xqdoc:uri>http://zorba.io/modules/excel/lookup</xqdoc:uri><xqdoc:name>lookup-column</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="5"><xqdoc:comment><xqdoc:description> Same as above, with range_lookup defaulted to true.
 It finds the largest value that is less than or equal to lookup_value.
 First column must be in ascending order.
</xqdoc:description><xqdoc:param>$lookup_value the value to be searched. Allowed types are numeric, string, boolean. <p/> Boolean values are compared only with booleans. Numbers are compared only with numbers, if range_lookup is not zero. The other types are converted to string and compared to string value of all values.</xqdoc:param><xqdoc:param>$table_array the sequence of values, row after row</xqdoc:param><xqdoc:param>$table_width the number of values in a row</xqdoc:param><xqdoc:param>$table_height the number of rows</xqdoc:param><xqdoc:param>$col_index_num the row index, 1 based</xqdoc:param><xqdoc:return>The value found, with original type</xqdoc:return><xqdoc:error>excel-err:Value if the array contains less elements than specified by table_height and table_width</xqdoc:error><xqdoc:error>excel-err:Value if col_index_num is outside the range 1 .. table_height</xqdoc:error><xqdoc:error>excel-err:Value if range_lookup is true and the value searched is smaller than the first value in the first column</xqdoc:error><xqdoc:error>excel-err:Value if range_lookup=false and the value cannot be found</xqdoc:error><xqdoc:see>http://office.microsoft.com/en-us/excel/HP052093351033.aspx</xqdoc:see><xqdoc:custom tag="example">test/Queries/excel/lookup/vlookup1.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/vlookup2.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/vlookup3.xq</xqdoc:custom><xqdoc:custom tag="example">test/Queries/excel/lookup/vlookup5.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>excel:vlookup</xqdoc:name><xqdoc:signature>declare function excel:vlookup($lookup_value as xs:anyAtomicType, $table_array as xs:anyAtomicType+, $table_width as xs:integer, $table_height as xs:integer, $col_index_num as xs:integer) as xs:anyAtomicType</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>lookup_value</xqdoc:name><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>table_array</xqdoc:name><xqdoc:type occurrence="+">xs:anyAtomicType</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>table_width</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>table_height</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>col_index_num</xqdoc:name><xqdoc:type>xs:integer</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:anyAtomicType</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>true</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="6"><xqdoc:uri>http://zorba.io/modules/excel/lookup</xqdoc:uri><xqdoc:name>vlookup</xqdoc:name></xqdoc:invoked></xqdoc:function></xqdoc:functions></xqdoc:xqdoc>