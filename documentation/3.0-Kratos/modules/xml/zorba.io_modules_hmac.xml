<xqdoc:xqdoc xmlns:xqdoc="http://www.xqdoc.org/1.0"><xqdoc:control><xqdoc:date>2013-12-04T01:28:38.942159+01:00</xqdoc:date><xqdoc:version>1.0</xqdoc:version></xqdoc:control><xqdoc:module type="library"><xqdoc:uri>http://zorba.io/modules/hmac</xqdoc:uri><xqdoc:name>hmac</xqdoc:name><xqdoc:comment><xqdoc:description> This module provides functions that perform HMAC
 (hash-based message authentication code) operations.
 For example, they calculate message codes involving hash functions such
 as MD5 and various SHA variants. The result is the base64 encoded value
 of the hash. A hash may be used to verify the data integrity and
 the authenticity of a message.
</xqdoc:description><xqdoc:author>William Candillon, Matthias Brantner</xqdoc:author><xqdoc:custom tag="project">Zorba/Cryptography/HMAC</xqdoc:custom><xqdoc:custom tag="language">xquery</xqdoc:custom><xqdoc:custom tag="version">3.0</xqdoc:custom><xqdoc:custom tag="encoding">utf-8</xqdoc:custom></xqdoc:comment><xqdoc:custom tag="namespaces"><xqdoc:namespace prefix="hmac" uri="http://zorba.io/modules/hmac" isSchema="false"/><xqdoc:namespace prefix="ver" uri="http://zorba.io/options/versioning" isSchema="false"/></xqdoc:custom></xqdoc:module><xqdoc:imports/><xqdoc:variables/><xqdoc:collections/><xqdoc:indexes/><xqdoc:functions><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Calculate the HMAC for the given message and secret-key involving
 the MD5 hash function.
</xqdoc:description><xqdoc:param>$message the message to be authenticated</xqdoc:param><xqdoc:param>$secret-key the secret key used for calculating the authentication</xqdoc:param><xqdoc:return>the base64 encoded message authentication code</xqdoc:return></xqdoc:comment><xqdoc:name>hmac:md5</xqdoc:name><xqdoc:signature>declare function hmac:md5($message as xs:string, $secret-key as xs:string) as xs:base64Binary</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>message</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>secret-key</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:base64Binary</xqdoc:type></xqdoc:return><xqdoc:invoked arity="3"><xqdoc:uri>http://zorba.io/modules/hmac</xqdoc:uri><xqdoc:name>compute</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Calculate the HMAC for the given message and secret-key involving
 the SHA1 hash function.
</xqdoc:description><xqdoc:param>$message the message to be authenticated</xqdoc:param><xqdoc:param>$secret-key the secret key used for calculating the authentication</xqdoc:param><xqdoc:return>the base64 encoded message authentication code</xqdoc:return></xqdoc:comment><xqdoc:name>hmac:sha1</xqdoc:name><xqdoc:signature>declare function hmac:sha1($message as xs:string, $secret-key as xs:string) as xs:base64Binary</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>message</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>secret-key</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:base64Binary</xqdoc:type></xqdoc:return><xqdoc:invoked arity="3"><xqdoc:uri>http://zorba.io/modules/hmac</xqdoc:uri><xqdoc:name>compute</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Calculate the HMAC for the given message and secret-key involving
 the MD5 hash function. Before calculating the code, the given
 base64-encoded message is base64-decoded.
</xqdoc:description><xqdoc:param>$message the message to be authenticated</xqdoc:param><xqdoc:param>$secret-key the secret key used for calculating the authentication</xqdoc:param><xqdoc:return>the base64 encoded message authentication code</xqdoc:return></xqdoc:comment><xqdoc:name>hmac:md5-binary</xqdoc:name><xqdoc:signature>declare function hmac:md5-binary($message as xs:base64Binary, $secret-key as xs:string) as xs:base64Binary</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>message</xqdoc:name><xqdoc:type>xs:base64Binary</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>secret-key</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:base64Binary</xqdoc:type></xqdoc:return><xqdoc:invoked arity="3"><xqdoc:uri>http://zorba.io/modules/hmac</xqdoc:uri><xqdoc:name>compute-binary</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Calculate the HMAC for the given message and secret-key involving
 the SHA1 hash function. Before calculating the code, the given
 base64-encoded message is base64-decoded.
</xqdoc:description><xqdoc:param>$message the message to be authenticated</xqdoc:param><xqdoc:param>$secret-key the secret key used for calculating the authentication</xqdoc:param><xqdoc:return>the base64 encoded message authentication code</xqdoc:return></xqdoc:comment><xqdoc:name>hmac:sha1-binary</xqdoc:name><xqdoc:signature>declare function hmac:sha1-binary($message as xs:base64Binary, $secret-key as xs:string) as xs:base64Binary</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>message</xqdoc:name><xqdoc:type>xs:base64Binary</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>secret-key</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:base64Binary</xqdoc:type></xqdoc:return><xqdoc:invoked arity="3"><xqdoc:uri>http://zorba.io/modules/hmac</xqdoc:uri><xqdoc:name>compute-binary</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> Calculate the HMAC for the given message and secret-key involving
 an custom hash function.
</xqdoc:description><xqdoc:param>$message the message to be authenticated</xqdoc:param><xqdoc:param>$secret-key the secret key used for calculating the authentication</xqdoc:param><xqdoc:param>$alg The algorithm to use for the hashing operation. Supported algorithms are "md5", "sha1", and "sha256".</xqdoc:param><xqdoc:return>the base64 encoded message authentication code</xqdoc:return><xqdoc:error>hash:UNSUPPORTED-ALGORITHM if the given hash algorithm is not supported</xqdoc:error></xqdoc:comment><xqdoc:name>hmac:compute</xqdoc:name><xqdoc:signature>declare function hmac:compute($message as xs:string, $secret-key as xs:string, $alg as xs:string) as xs:base64Binary external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>message</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>secret-key</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>alg</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:base64Binary</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> Calculate the HMAC for the given message and secret-key involving
 an custom hash function. Before calculating the code, the given
 base64-encoded message is base64-decoded.
</xqdoc:description><xqdoc:param>$message the message to be authenticated</xqdoc:param><xqdoc:param>$secret-key the secret key used for calculating the authentication</xqdoc:param><xqdoc:param>$alg The algorithm to use for the hashing operation. Supported algorithms are "md5", "sha1", and "sha256".</xqdoc:param><xqdoc:return>the base64 encoded message authentication code</xqdoc:return><xqdoc:error>hash:UNSUPPORTED-ALGORITHM if the given hash algorithm is not supported</xqdoc:error></xqdoc:comment><xqdoc:name>hmac:compute-binary</xqdoc:name><xqdoc:signature>declare function hmac:compute-binary($message as xs:base64Binary, $secret-key as xs:string, $hash-algo as xs:string) as xs:base64Binary external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>message</xqdoc:name><xqdoc:type>xs:base64Binary</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>secret-key</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>hash-algo</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:base64Binary</xqdoc:type></xqdoc:return></xqdoc:function></xqdoc:functions></xqdoc:xqdoc>