<xqdoc:xqdoc xmlns:xqdoc="http://www.xqdoc.org/1.0"><xqdoc:control><xqdoc:date>2013-12-04T01:28:38.942159+01:00</xqdoc:date><xqdoc:version>1.0</xqdoc:version></xqdoc:control><xqdoc:module type="library"><xqdoc:uri>http://zorba.io/modules/datetime</xqdoc:uri><xqdoc:name>datetime</xqdoc:name><xqdoc:comment><xqdoc:description> <p>This module provides functions to retrieve the current dateTime and to
 parse dates and times.</p>
 <p/>
 <p>In contrast to the current-dateTime functions specified in
 <a href="http://www.w3.org/TR/xpath-functions-30/">XQuery Functions and
 Operators</a>, the functions in this module are nondeterministic, that is,
 they do not return the current dateTime from the dynamic context, but return
 the actual value.</p>
 <p/>
 <p>Dates and times are parsed according to the format given by
 <a href="http://pubs.opengroup.org/onlinepubs/007904975/functions/strptime.html">strptime</a>.</p>
 <p>However, date and time values must be "complete."</p>
 <p>For a date, the year and either month and day or day of the year must have
 been parsed.</p>
 <p>For a time, the hour must have been parsed.
 (If either the minute, second, or timezone has not been parsed, they default
 to 0.)</p>
 <p>For a dateTime, the parsing requirements of both date and time must be met.</p>
 <p/>
 <p>When a locale is given,
 it must be of the form {lang}[{sep}{country}[{encoding}]] where
 {lang} is an ISO 639-1 2-letter or 639-2 3-letter language code,
 {sep} is either '-' or '_',
 {country} is an ISO 3166-1 2-letter country code,
 and {encoding} is any string that begins with a '.'.</p>
 <p>The {sep}, {country}, and {encoding} are optional;
 {encoding} is always ignored.</p>
 <p>Examples include: de, en-US, fr_CA, ru_RU.UTF-8.</p>
</xqdoc:description><xqdoc:author>Matthias Brantner</xqdoc:author><xqdoc:author>Paul J. Lucas</xqdoc:author><xqdoc:see>http://www.w3.org/TR/xpath-functions/#context</xqdoc:see><xqdoc:custom tag="project">Zorba/XML and JSON Data Model/Atomic/Datetime</xqdoc:custom><xqdoc:custom tag="language">xquery</xqdoc:custom><xqdoc:custom tag="version">3.0</xqdoc:custom><xqdoc:custom tag="encoding">utf-8</xqdoc:custom></xqdoc:comment><xqdoc:custom tag="namespaces"><xqdoc:namespace prefix="an" uri="http://zorba.io/annotations" isSchema="false"/><xqdoc:namespace prefix="datetime" uri="http://zorba.io/modules/datetime" isSchema="false"/><xqdoc:namespace prefix="ver" uri="http://zorba.io/options/versioning" isSchema="false"/></xqdoc:custom></xqdoc:module><xqdoc:imports/><xqdoc:variables/><xqdoc:collections/><xqdoc:indexes/><xqdoc:functions><xqdoc:function arity="0"><xqdoc:comment><xqdoc:description> <p>Gets the current date value in Universal time.</p>
 <p>Note that this function is not stable: it returns the value of the date when
 the function is invoked.</p>
</xqdoc:description><xqdoc:return>the non-stable date value</xqdoc:return></xqdoc:comment><xqdoc:name>datetime:current-date</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function datetime:current-date() as xs:date external</xqdoc:signature><xqdoc:return><xqdoc:type>xs:date</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="0"><xqdoc:comment><xqdoc:description> <p>Gets the current dateTime value in Universal time.</p>
 <p>Note that this function is not stable: it returns the value of the date and
 time when the function is invoked.</p>
</xqdoc:description><xqdoc:return>the non-stable datetime value</xqdoc:return></xqdoc:comment><xqdoc:name>datetime:current-dateTime</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function datetime:current-dateTime() as xs:dateTimeStamp external</xqdoc:signature><xqdoc:return><xqdoc:type>xs:dateTimeStamp</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="0"><xqdoc:comment><xqdoc:description> <p>Return the current time value in Universal time.</p>
 <p>Note that this function is not stable: it returns the value of the time when
 the function is invoked.</p>
</xqdoc:description><xqdoc:return>the non-stable time value</xqdoc:return></xqdoc:comment><xqdoc:name>datetime:current-time</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function datetime:current-time() as xs:time external</xqdoc:signature><xqdoc:return><xqdoc:type>xs:time</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> <p>Parses a date from a string in the current locale.</p>
</xqdoc:description><xqdoc:param>$input The string to parse.</xqdoc:param><xqdoc:param>$format The format string containing zero or more conversion specifications and ordinary characters. All ordinary characters are matched exactly with the buffer; all whitespace characters match any amount of whitespace in the buffer.</xqdoc:param><xqdoc:return>Returns an xs:date.</xqdoc:return><xqdoc:error>datetime:INVALID_SPECIFICATION if $format contains an invalid conversion specification.</xqdoc:error><xqdoc:error>datetime:INSUFFICIENT_BUFFER if $input is insufficient for $format.</xqdoc:error><xqdoc:error>datetime:INVALID_VALUE if $input contains an invalid value for a conversion specification.</xqdoc:error><xqdoc:error>datetime:LITERAL_MISMATCH if there is a literal characer mismatch between $input and $format.</xqdoc:error><xqdoc:error>datetime:INCOMPLETE_DATE_OR_TIME if the date is incomplete.</xqdoc:error><xqdoc:custom tag="example">test/rbkt/Queries/zorba/datetime/datetime-parse-date-uD-1.xq</xqdoc:custom><xqdoc:custom tag="example">test/rbkt/Queries/zorba/datetime/datetime-parse-date-uF-1.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>datetime:parse-date</xqdoc:name><xqdoc:signature>declare function datetime:parse-date($input as xs:string, $format as xs:string) as xs:date external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>input</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>format</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:date</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> <p>Parses a date from a string in the given locale.</p>
</xqdoc:description><xqdoc:param>$input The string to parse.</xqdoc:param><xqdoc:param>$format The format string containing zero or more conversion specifications and ordinary characters. All ordinary characters are matched exactly with the buffer; all whitespace characters match any amount of whitespace in the buffer.</xqdoc:param><xqdoc:param>$locale The locale to use.</xqdoc:param><xqdoc:return>Returns an xs:date.</xqdoc:return><xqdoc:error>datetime:INVALID_SPECIFICATION if $format contains an invalid conversion specification.</xqdoc:error><xqdoc:error>datetime:INSUFFICIENT_BUFFER if $input is insufficient for $format.</xqdoc:error><xqdoc:error>datetime:INVALID_VALUE if $input contains an invalid value for a conversion specification.</xqdoc:error><xqdoc:error>datetime:LITERAL_MISMATCH if there is a literal characer mismatch between $input and $format.</xqdoc:error><xqdoc:error>datetime:INCOMPLETE_DATE_OR_TIME if the date is incomplete.</xqdoc:error><xqdoc:error>datetime:INVALID_LOCALE if $locale is in an invalid format.</xqdoc:error><xqdoc:error>datetime:UNKNOWN_LOCALE if $locale is unknown.</xqdoc:error><xqdoc:error>datetime:UNSUPPORTED_LOCALE if $locale is unsupported by the operating system.</xqdoc:error><xqdoc:custom tag="example">test/rbkt/Queries/zorba/datetime/datetime-parse-date-la-uD-1.xq</xqdoc:custom><xqdoc:custom tag="example">test/rbkt/Queries/zorba/datetime/datetime-parse-date-uA-uD-2.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>datetime:parse-date</xqdoc:name><xqdoc:signature>declare function datetime:parse-date($input as xs:string, $format as xs:string, $locale as xs:string) as xs:date external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>input</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>format</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>locale</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:date</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> <p>Parses a dateTime from a string in the current locale.</p>
</xqdoc:description><xqdoc:param>$input The string to parse.</xqdoc:param><xqdoc:param>$format The format string containing zero or more conversion specifications and ordinary characters. All ordinary characters are matched exactly with the buffer; all whitespace characters match any amount of whitespace in the buffer.</xqdoc:param><xqdoc:return>Returns an xs:dateTime.</xqdoc:return><xqdoc:error>datetime:INVALID_SPECIFICATION if $format contains an invalid conversion specification.</xqdoc:error><xqdoc:error>datetime:INSUFFICIENT_BUFFER if $input is insufficient for $format.</xqdoc:error><xqdoc:error>datetime:INVALID_VALUE if $input contains an invalid value for a conversion specification.</xqdoc:error><xqdoc:error>datetime:LITERAL_MISMATCH if there is a literal characer mismatch between $input and $format.</xqdoc:error><xqdoc:error>datetime:INCOMPLETE_DATE_OR_TIME if either the date or time is incomplete.</xqdoc:error><xqdoc:custom tag="example">test/rbkt/Queries/zorba/datetime/datetime-parse-dateTime-uFTZ-1.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>datetime:parse-dateTime</xqdoc:name><xqdoc:signature>declare function datetime:parse-dateTime($input as xs:string, $format as xs:string) as xs:dateTime external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>input</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>format</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:dateTime</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> <p>Parses a dateTime from a string in the given locale.</p>
</xqdoc:description><xqdoc:param>$input The string to parse.</xqdoc:param><xqdoc:param>$format The format string containing zero or more conversion specifications and ordinary characters. All ordinary characters are matched exactly with the buffer; all whitespace characters match any amount of whitespace in the buffer.</xqdoc:param><xqdoc:param>$locale The locale to use.</xqdoc:param><xqdoc:return>Returns an xs:dateTime.</xqdoc:return><xqdoc:error>datetime:INVALID_SPECIFICATION if $format contains an invalid conversion specification.</xqdoc:error><xqdoc:error>datetime:INSUFFICIENT_BUFFER if $input is insufficient for $format.</xqdoc:error><xqdoc:error>datetime:INVALID_VALUE if $input contains an invalid value for a conversion specification.</xqdoc:error><xqdoc:error>datetime:LITERAL_MISMATCH if there is a literal characer mismatch between $input and $format.</xqdoc:error><xqdoc:error>datetime:INCOMPLETE_DATE_OR_TIME if either the date or time is incomplete.</xqdoc:error><xqdoc:error>datetime:INVALID_LOCALE if $locale is in an invalid format.</xqdoc:error><xqdoc:error>datetime:UNKNOWN_LOCALE if $locale is unknown.</xqdoc:error><xqdoc:error>datetime:UNSUPPORTED_LOCALE if $locale is unsupported by the operating system.</xqdoc:error><xqdoc:custom tag="example">test/rbkt/Queries/zorba/datetime/datetime-parse-dateTime-uAB-ld-uYTZ-1.xq</xqdoc:custom><xqdoc:custom tag="example">test/rbkt/Queries/zorba/datetime/datetime-parse-dateTime-uAB-ld-uYTZ-2.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>datetime:parse-dateTime</xqdoc:name><xqdoc:signature>declare function datetime:parse-dateTime($input as xs:string, $format as xs:string, $locale as xs:string) as xs:dateTime external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>input</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>format</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>locale</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:dateTime</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> <p>Parses a time from a string in the current locale.</p>
</xqdoc:description><xqdoc:param>$input The string to parse.</xqdoc:param><xqdoc:param>$format The format string containing zero or more conversion specifications and ordinary characters. All ordinary characters are matched exactly with the buffer; all whitespace characters match any amount of whitespace in the buffer.</xqdoc:param><xqdoc:return>Returns an xs:time.</xqdoc:return><xqdoc:error>datetime:INVALID_SPECIFICATION if $format contains an invalid conversion specification.</xqdoc:error><xqdoc:error>datetime:INSUFFICIENT_BUFFER if $input is insufficient for $format.</xqdoc:error><xqdoc:error>datetime:INVALID_VALUE if $input contains an invalid value for a conversion specification.</xqdoc:error><xqdoc:error>datetime:LITERAL_MISMATCH if there is a literal characer mismatch between $input and $format.</xqdoc:error><xqdoc:error>datetime:INCOMPLETE_DATE_OR_TIME if the hour has not been parsed.</xqdoc:error><xqdoc:custom tag="example">test/rbkt/Queries/zorba/datetime/datetime-parse-time-uH-1.xq</xqdoc:custom><xqdoc:custom tag="example">test/rbkt/Queries/zorba/datetime/datetime-parse-time-uIMS-1.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>datetime:parse-time</xqdoc:name><xqdoc:signature>declare function datetime:parse-time($input as xs:string, $format as xs:string) as xs:time external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>input</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>format</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:time</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> <p>Parses a time from a string in the given locale.</p>
</xqdoc:description><xqdoc:param>$input The string to parse.</xqdoc:param><xqdoc:param>$format The format string containing zero or more conversion specifications and ordinary characters. All ordinary characters are matched exactly with the buffer; all whitespace characters match any amount of whitespace in the buffer.</xqdoc:param><xqdoc:param>$locale The locale to use.</xqdoc:param><xqdoc:return>Returns an xs:time.</xqdoc:return><xqdoc:error>datetime:INVALID_SPECIFICATION if $format contains an invalid conversion specification.</xqdoc:error><xqdoc:error>datetime:INSUFFICIENT_BUFFER if $input is insufficient for $format.</xqdoc:error><xqdoc:error>datetime:INVALID_VALUE if $input contains an invalid value for a conversion specification.</xqdoc:error><xqdoc:error>datetime:LITERAL_MISMATCH if there is a literal characer mismatch between $input and $format.</xqdoc:error><xqdoc:error>datetime:INCOMPLETE_DATE_OR_TIME if the hour has not been parsed.</xqdoc:error><xqdoc:error>datetime:INVALID_LOCALE if $locale is in an invalid format.</xqdoc:error><xqdoc:error>datetime:UNKNOWN_LOCALE if $locale is unknown.</xqdoc:error><xqdoc:error>datetime:UNSUPPORTED_LOCALE if $locale is unsupported by the operating system.</xqdoc:error><xqdoc:custom tag="example">test/rbkt/Queries/zorba/datetime/datetime-parse-time-lr-1.xq</xqdoc:custom><xqdoc:custom tag="example">test/rbkt/Queries/zorba/datetime/datetime-parse-time-lr-2.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>datetime:parse-time</xqdoc:name><xqdoc:signature>declare function datetime:parse-time($input as xs:string, $format as xs:string, $locale as xs:string) as xs:time external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>input</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>format</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>locale</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:time</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> <p>Converts the given number of milliseconds since epoch into its corresponding
 xs:dateTime.</p>
</xqdoc:description><xqdoc:param>$millis The number of milliseconds since epoch.</xqdoc:param><xqdoc:return>Returns an xs:dateTime.</xqdoc:return><xqdoc:custom tag="example">test/rbkt/Queries/zorba/datetime/datetime-millis-to-dateTime-1.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>datetime:millis-to-dateTime</xqdoc:name><xqdoc:signature>declare function datetime:millis-to-dateTime($millis as xs:long) as xs:dateTime external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>millis</xqdoc:name><xqdoc:type>xs:long</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:dateTime</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="0"><xqdoc:comment><xqdoc:description> <p>Gets the the number of milliseconds since epoch.</p>
</xqdoc:description><xqdoc:return>the said number of milliseconds.</xqdoc:return></xqdoc:comment><xqdoc:name>datetime:timestamp</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function datetime:timestamp() as xs:long external</xqdoc:signature><xqdoc:return><xqdoc:type>xs:long</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="0"><xqdoc:comment><xqdoc:description> <p>Gets the offset of the current timezone from Universal time.</p>
</xqdoc:description><xqdoc:return>the offset in seconds with positive values being east of the prime meridian.</xqdoc:return></xqdoc:comment><xqdoc:name>datetime:utc-offset</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function datetime:utc-offset() as xs:long external</xqdoc:signature><xqdoc:return><xqdoc:type>xs:long</xqdoc:type></xqdoc:return></xqdoc:function></xqdoc:functions></xqdoc:xqdoc>