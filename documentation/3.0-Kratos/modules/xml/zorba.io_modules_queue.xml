<xqdoc:xqdoc xmlns:xqdoc="http://www.xqdoc.org/1.0"><xqdoc:control><xqdoc:date>2013-12-04T01:28:38.942159+01:00</xqdoc:date><xqdoc:version>1.0</xqdoc:version></xqdoc:control><xqdoc:module type="library"><xqdoc:uri>http://zorba.io/modules/queue</xqdoc:uri><xqdoc:name>queue</xqdoc:name><xqdoc:comment><xqdoc:description> Implementation of queue for items, using dynamic collections.<p/>
 Entries in the queue must be structured items - that is, either JSON
 Objects or Arrays, or XML Nodes. <p/>
</xqdoc:description><xqdoc:author>Daniel Turcanu, Sorin Nasoi</xqdoc:author><xqdoc:custom tag="project">Zorba/Data Store/Data Structures/Queue</xqdoc:custom><xqdoc:custom tag="language">xquery</xqdoc:custom><xqdoc:custom tag="version">3.0</xqdoc:custom><xqdoc:custom tag="encoding">utf-8</xqdoc:custom></xqdoc:comment><xqdoc:custom tag="namespaces"><xqdoc:namespace prefix="ann" uri="http://zorba.io/annotations" isSchema="false"/><xqdoc:namespace prefix="collections-ddl" uri="http://zorba.io/modules/store/dynamic/collections/ddl" isSchema="false"/><xqdoc:namespace prefix="collections-dml" uri="http://zorba.io/modules/store/dynamic/collections/dml" isSchema="false"/><xqdoc:namespace prefix="queue" uri="http://zorba.io/modules/queue" isSchema="false"/><xqdoc:namespace prefix="ver" uri="http://zorba.io/options/versioning" isSchema="false"/></xqdoc:custom></xqdoc:module><xqdoc:imports><xqdoc:import type="library"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/ddl</xqdoc:uri></xqdoc:import><xqdoc:import type="library"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/dml</xqdoc:uri></xqdoc:import></xqdoc:imports><xqdoc:variables><xqdoc:variable><xqdoc:uri>queue:ERR-NS</xqdoc:uri><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations></xqdoc:variable><xqdoc:variable><xqdoc:uri>queue:NOT-EXISTS</xqdoc:uri><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations></xqdoc:variable><xqdoc:variable><xqdoc:uri>queue:EXISTS</xqdoc:uri><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations></xqdoc:variable></xqdoc:variables><xqdoc:collections/><xqdoc:indexes/><xqdoc:functions><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Create a queue with the name given. If a queue with the given name already exists, an error is raised. <p/>
</xqdoc:description><xqdoc:param>$name name of the new queue.</xqdoc:param><xqdoc:return>an empty sequence.</xqdoc:return><xqdoc:error>queue:EXISTS if the queue identified by $name already exists.</xqdoc:error></xqdoc:comment><xqdoc:name>queue:create</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="ann" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %ann:sequential function queue:create($name as xs:QName) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>name</xqdoc:name><xqdoc:type>xs:QName</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/ddl</xqdoc:uri><xqdoc:name>create</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/ddl</xqdoc:uri><xqdoc:name>is-available-collection</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Return the first item in the queue (the first added), without removing it. <p/>
</xqdoc:description><xqdoc:param>$name name of the queue.</xqdoc:param><xqdoc:return>the first item, or empty sequence if queue is empty.</xqdoc:return><xqdoc:error>queue:NOT-EXISTS if the queue identified by $name does not exist.</xqdoc:error><xqdoc:custom tag="example">test/Queries/front1.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>queue:front</xqdoc:name><xqdoc:signature>declare function queue:front($name as xs:QName) as structured-item()?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>name</xqdoc:name><xqdoc:type>xs:QName</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">structured-item()?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>not</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/ddl</xqdoc:uri><xqdoc:name>is-available-collection</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/dml</xqdoc:uri><xqdoc:name>collection</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Return the last item in the queue (the last added), without removing it. <p/>
</xqdoc:description><xqdoc:param>$name name of the queue.</xqdoc:param><xqdoc:return>the last item, or empty sequence if queue is empty.</xqdoc:return><xqdoc:error>queue:NOT-EXISTS if the queue identified by $name does not exist.</xqdoc:error><xqdoc:custom tag="example">test/Queries/back1.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>queue:back</xqdoc:name><xqdoc:signature>declare function queue:back($name as xs:QName) as structured-item()?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>name</xqdoc:name><xqdoc:type>xs:QName</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">structured-item()?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="0"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>last</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>not</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/ddl</xqdoc:uri><xqdoc:name>is-available-collection</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/dml</xqdoc:uri><xqdoc:name>collection</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Return the first item in the queue, and remove it. <p/>
</xqdoc:description><xqdoc:param>$name name of the queue.</xqdoc:param><xqdoc:return>the first item, or empty sequence if queue is empty.</xqdoc:return><xqdoc:error>queue:NOT-EXISTS if the queue identified by $name does not exist.</xqdoc:error><xqdoc:custom tag="example">test/Queries/pop2.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>queue:pop</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="ann" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %ann:sequential function queue:pop($name as xs:QName) as structured-item()?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>name</xqdoc:name><xqdoc:type>xs:QName</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">structured-item()?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>not</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/ddl</xqdoc:uri><xqdoc:name>is-available-collection</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/dml</xqdoc:uri><xqdoc:name>collection</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/dml</xqdoc:uri><xqdoc:name>delete-first</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Add a new item to the queue; the queue will contain a copy of the given item. <p/>
</xqdoc:description><xqdoc:param>$name name of the queue.</xqdoc:param><xqdoc:param>$value the item to be added.</xqdoc:param><xqdoc:return>()</xqdoc:return><xqdoc:error>queue:NOT-EXISTS if the queue identified by $name does not exist.</xqdoc:error><xqdoc:custom tag="example">test/Queries/push1.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>queue:push</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="ann" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %ann:sequential function queue:push($name as xs:QName, $value as structured-item()) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>name</xqdoc:name><xqdoc:type>xs:QName</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>value</xqdoc:name><xqdoc:type>structured-item()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>not</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/ddl</xqdoc:uri><xqdoc:name>is-available-collection</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/dml</xqdoc:uri><xqdoc:name>apply-insert-last</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Checks if a queue exists and is empty. <p/>
</xqdoc:description><xqdoc:param>$name name of the queue.</xqdoc:param><xqdoc:return>true is the queue is empty, false if it is not empty.</xqdoc:return><xqdoc:error>queue:NOT-EXISTS if the queue identified by $name does not exist.</xqdoc:error><xqdoc:custom tag="example">test/Queries/empty1.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>queue:empty</xqdoc:name><xqdoc:signature>declare function queue:empty($name as xs:QName) as xs:boolean</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>name</xqdoc:name><xqdoc:type>xs:QName</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:boolean</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>empty</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>not</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/ddl</xqdoc:uri><xqdoc:name>is-available-collection</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/dml</xqdoc:uri><xqdoc:name>collection</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Count of items in the queue. <p/>
</xqdoc:description><xqdoc:param>$name name of the queue.</xqdoc:param><xqdoc:return>the count of items.</xqdoc:return><xqdoc:error>queue:NOT-EXISTS if the queue identified by $name does not exist.</xqdoc:error><xqdoc:custom tag="example">test/Queries/size1.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>queue:size</xqdoc:name><xqdoc:signature>declare function queue:size($name as xs:QName) as xs:integer</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>name</xqdoc:name><xqdoc:type>xs:QName</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:integer</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>count</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>not</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/ddl</xqdoc:uri><xqdoc:name>is-available-collection</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/dml</xqdoc:uri><xqdoc:name>collection</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> Copy all items from source queue to a destination queue. <p/>
 If destination queue does not exist, it is created first. <p/>
 If destination queue is not empty, the items are appended last. <p/>
</xqdoc:description><xqdoc:param>$destName name of the destination queue.</xqdoc:param><xqdoc:param>$sourceName name of the source queue.</xqdoc:param><xqdoc:return>an empty sequence.</xqdoc:return><xqdoc:custom tag="example">test/Queries/copy1.xq</xqdoc:custom></xqdoc:comment><xqdoc:name>queue:copy</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="ann" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %ann:sequential function queue:copy($destName as xs:QName, $sourceName as xs:QName) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>destName</xqdoc:name><xqdoc:type>xs:QName</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>sourceName</xqdoc:name><xqdoc:type>xs:QName</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>not</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/ddl</xqdoc:uri><xqdoc:name>create</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/ddl</xqdoc:uri><xqdoc:name>is-available-collection</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/dml</xqdoc:uri><xqdoc:name>collection</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://zorba.io/modules/store/dynamic/collections/dml</xqdoc:uri><xqdoc:name>insert-last</xqdoc:name></xqdoc:invoked></xqdoc:function></xqdoc:functions></xqdoc:xqdoc>