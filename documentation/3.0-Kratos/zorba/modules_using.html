<div class="doxygen">
  <div><h1 class="title">Using Modules in Zorba</h1>
<div id="mod_importing" class="sect1"><h2>Importing Modules</h2>
To make use of a particular module in your query, you must first <em>import</em> the module. XQuery provides standard syntax for doing this:<pre class="ace-static" ace-mode="xquery"><span class="keyword">import</span><span class="normal"><span> </span>module<span> </span></span><span class="keyword">namespace<span> </span></span><span class="normal"><a href="/pages/3.0/zorba/namespacezorba_1_1fs?anchor=a33bc6a07dd3ac39c5107606fc21bea22ad51f6a8152afdfbcf0e0dd0d1c86cee0">file</a><span> </span>=<span> </span></span><span class="stringliteral">"http://expath.org/ns/file"</span><span class="normal">;</span>
</pre>This will load all the functions and variables declared by the named module into your query, and associate the specified prefix (in this case "file") with the URI of the module. You can then utilize these functions in your query:<pre class="ace-static" ace-mode="xquery"><span class="keyword">import</span><span class="normal"><span> </span>module<span> </span></span><span class="keyword">namespace<span> </span></span><span class="normal"><a href="/pages/3.0/zorba/namespacezorba_1_1fs?anchor=a33bc6a07dd3ac39c5107606fc21bea22ad51f6a8152afdfbcf0e0dd0d1c86cee0">file</a><span> </span>=<span> </span></span><span class="stringliteral">"http://expath.org/ns/file"</span><span class="normal">;</span>
<span class="normal"/>
<span class="normal"/><span class="keywordflow">if</span><span class="normal"><span> </span>(<a href="/pages/3.0/zorba/namespacezorba_1_1fs?anchor=a33bc6a07dd3ac39c5107606fc21bea22ad51f6a8152afdfbcf0e0dd0d1c86cee0">file</a>:<a href="/pages/3.0/zorba/namespacezorba_1_1locale_1_1iso639__1?anchor=aafd6e55905dc8efe50a3f9fd38616781a11cc1dd79aff8b41628c4f17295d25a7">is</a>-<a href="/pages/3.0/zorba/namespacezorba_1_1fs?anchor=a33bc6a07dd3ac39c5107606fc21bea22ad51f6a8152afdfbcf0e0dd0d1c86cee0">file</a>(</span><span class="stringliteral">"foo.txt"</span><span class="normal">))</span>
<span class="normal">then<span> </span><a href="/pages/3.0/zorba/namespacezorba_1_1fs?anchor=a33bc6a07dd3ac39c5107606fc21bea22ad51f6a8152afdfbcf0e0dd0d1c86cee0">file</a>:</span><span class="keyword">delete</span><span class="normal">(</span><span class="stringliteral">"foo.txt"</span><span class="normal">)</span>
<span class="normal"/><span class="keywordflow">else</span><span class="normal"><span> </span>()</span>
</pre>You may import as many modules as you wish, so long as each is at a unique URI and is associated with a unique prefix.<a href="../../../download" target="_blank">Please check here</a> for more information about importing <a href="/pages/3.0/zorba/modules_top?anchor=non_core_modules">Non-core Modules</a>.Note: the URI specified to <tt>import module</tt> will be resolved by Zorba's URI resolution mechanism; often this will result in the module being loaded from the local filesystem, even though most module URIs are in the <tt>http:</tt> scheme. For more information on this mechanism, see <a href="/pages/3.0/zorba/uriresolvers">URI Resolvers</a>.Alternately, you can load a specific file as a module as follows:<pre class="ace-static" ace-mode="xquery"><span class="keyword">import</span><span class="normal"><span> </span>module<span> </span></span><span class="keyword">namespace<span> </span></span><span class="normal"><a href="/pages/3.0/zorba/namespacezorba_1_1fs?anchor=a33bc6a07dd3ac39c5107606fc21bea22ad51f6a8152afdfbcf0e0dd0d1c86cee0">file</a><span> </span>=<span> </span></span><span class="stringliteral">"http://expath.org/ns/file"</span><span class="normal"><span> </span>at<span> </span></span><span class="stringliteral">"file.xq"</span><span class="normal">;</span>
</pre>As discussed in <a href="/pages/3.0/zorba/uriresolvers">URI Resolvers</a>, this technique is usually best avoided in larger applications; however, it is useful for quick testing and debugging.</div>
<div id="mod_versioning" class="sect1"><h2>Versioning Modules</h2>
Zorba extends XQuery with the concept of <em>versioned modules</em>. A given module may be made available in several versions over time, and a given installation of Zorba may have multiple versions available.Version numbers for modules in Zorba are of the form <em>major.minor[.patch]</em>. For example: "1.0", "2.5", and "2.5.1" are all legal version numbers.You import a particular version of a module by specifying the version number as a <em>fragment</em> at the end of the module's namespace URI. For instance, to import version 2.0 of the file module:<pre class="ace-static" ace-mode="xquery"><span class="keyword">import</span><span class="normal"><span> </span>module<span> </span></span><span class="keyword">namespace<span> </span></span><span class="normal"><a href="/pages/3.0/zorba/namespacezorba_1_1fs?anchor=a33bc6a07dd3ac39c5107606fc21bea22ad51f6a8152afdfbcf0e0dd0d1c86cee0">file</a><span> </span>=<span> </span></span><span class="stringliteral">"http://expath.org/ns/file#2.2"</span><span class="normal">;</span>
</pre><div id="mod_ver_implies" class="sect2"><h3>Implications of Version Numbers</h3>
Zorba presumes that a given <em>minor</em> version is backwards-compatible with any earlier <em>minor</em> version, but that later <em>minor</em> versions introduce additional API features that are not available in earlier versions. It will therefore allow a later <em>minor</em> version to be imported than is specified in the <tt>import module</tt> statement. For example, if version 2.4 of the file module is available, the above import statement will load it, even though the import statement specifies 2.2. On the other hand, if only version 2.0 of the file module available, the above import statement will <b>not</b> load it, because it is assumed that the query depends on features which were not introduced until version 2.2.Zorba presumes that a given <em>major</em> version may have incompatible changes to its API compared to a lower major version. It will therefore <b>not</b> allow a later <em>major</em> version to be imported than is specified in the <tt>import module</tt> statement. For example, if only version 3.3 of the file module is available, the above import statement will <b>not</b> load it, because it is assumed that version 3.x has API differences that are incompatible with version 2.x.Zorba treats <em>patch</em> versions (if present) in the same way as <em>minor</em> versions: they effectively occur "between" minor versions, and it is presumed that they may introduce new APIs which are not available in lower versions. So, given:<pre class="ace-static" ace-mode="xquery"><span class="keyword">import</span><span class="normal"><span> </span>module<span> </span></span><span class="keyword">namespace<span> </span></span><span class="normal"><a href="/pages/3.0/zorba/namespacezorba_1_1fs?anchor=a33bc6a07dd3ac39c5107606fc21bea22ad51f6a8152afdfbcf0e0dd0d1c86cee0">file</a><span> </span>=<span> </span></span><span class="stringliteral">"http://expath.org/ns/file#2.5.2"</span><span class="normal">;</span>
</pre>Zorba will, for example, import version 2.5.3, 2.6, or 2.6.1 if one of them is available. It will <b>not</b> import version 2.5.1 or 2.5.</div>
<div id="mod_ver_specifying" class="sect2"><h3>Specifying Version Ranges</h3>
You may import a range of version numbers, in which case Zorba will import the latest available version which matches the range. For example, if you know that any 2.x or 3.x version of the file module provides the APIs your query requires, you can use:<pre class="ace-static" ace-mode="xquery"><span class="keyword">import</span><span class="normal"><span> </span>module<span> </span></span><span class="keyword">namespace<span> </span></span><span class="normal"><a href="/pages/3.0/zorba/namespacezorba_1_1fs?anchor=a33bc6a07dd3ac39c5107606fc21bea22ad51f6a8152afdfbcf0e0dd0d1c86cee0">file</a><span> </span>=<span> </span></span><span class="stringliteral">"http://expath.org/ns/file#2.0-3.0"</span><span class="normal">;</span>
</pre>Zorba will import the latest 3.x version available; or, if there are no 3.x versions, then it will import the latest 2.x version.If you know you depend on functionality that was introduced in version 2.2, but that 3.x also will work, you can use:<pre class="ace-static" ace-mode="xquery"><span class="keyword">import</span><span class="normal"><span> </span>module<span> </span></span><span class="keyword">namespace<span> </span></span><span class="normal"><a href="/pages/3.0/zorba/namespacezorba_1_1fs?anchor=a33bc6a07dd3ac39c5107606fc21bea22ad51f6a8152afdfbcf0e0dd0d1c86cee0">file</a><span> </span>=<span> </span></span><span class="stringliteral">"http://expath.org/ns/file#2.2-3.0"</span><span class="normal">;</span>
</pre>In this case, Zorba will import the latest 3.x version available; or, if there are no 3.x versions, then it will import the latest 2.x version so long as it is at least 2.2.</div>
<div id="mod_ver_invalid" class="sect2"><h3>Invalid Version Ranges</h3>
Zorba presumes that all <em>minor</em> version increments are backwards-compatible. Therefore, the second version specified in a version range is actually "open-ended", because any higher <em>minor</em> (or <em>patch</em>) version may also be imported by Zorba. Because of this, the following version ranges are not valid:<pre class="ace-static" ace-mode="xquery"><span class="normal">(:<span> </span>Invalid<span> </span></span><span class="keyword">import</span><span class="normal"><span> </span>specification<span> </span>:)</span>
<span class="normal"/><span class="keyword">import</span><span class="normal"><span> </span>module<span> </span></span><span class="keyword">namespace</span><span class="normal"><span> </span><a href="/pages/3.0/zorba/namespacezorba_1_1fs?anchor=a33bc6a07dd3ac39c5107606fc21bea22ad51f6a8152afdfbcf0e0dd0d1c86cee0">file</a><span> </span>=<span> </span></span><span class="stringliteral">"http://expath.org/ns/file#2.2-3.8"</span><span class="normal">;</span>
</pre> <pre class="ace-static" ace-mode="xquery"><span class="normal">(:<span> </span>Invalid<span> </span></span><span class="keyword">import</span><span class="normal"><span> </span>specification<span> </span>:)</span>
<span class="normal"/><span class="keyword">import</span><span class="normal"><span> </span>module<span> </span></span><span class="keyword">namespace</span><span class="normal"><span> </span><a href="/pages/3.0/zorba/namespacezorba_1_1fs?anchor=a33bc6a07dd3ac39c5107606fc21bea22ad51f6a8152afdfbcf0e0dd0d1c86cee0">file</a><span> </span>=<span> </span></span><span class="stringliteral">"http://expath.org/ns/file#2.2-2.4"</span><span class="normal">;</span>
</pre>In fact, to ensure that there is no confusion about this, Zorba requires that the second version in a version range be of the form "X.0" - that is, the minor version must be "0", and there must be no patch version.</div>
<div id="mod_ver_explicit" class="sect2"><h3>Explicit Version Import</h3>
Zorba does allow one override of its assumptions about API compatibility. If you wish to import version 2.4 and no other version (even a higher minor version), use:<pre class="ace-static" ace-mode="xquery"><span class="keyword">import</span><span class="normal"><span> </span>module<span> </span></span><span class="keyword">namespace<span> </span></span><span class="normal"><a href="/pages/3.0/zorba/namespacezorba_1_1fs?anchor=a33bc6a07dd3ac39c5107606fc21bea22ad51f6a8152afdfbcf0e0dd0d1c86cee0">file</a><span> </span>=<span> </span></span><span class="stringliteral">"http://expath.org/ns/file#2.4!"</span><span class="normal">;</span>
</pre>with an exclamation point (!) after the version.This should only be used in cases where the module author did not follow Zorba's conventions, and introduced backwards-incompatible changes in version 2.5. This feature is intentionally very limited, as it is not recommended practice. In particular, you cannot use ! in conjunction with version ranges.</div>
<div id="mod_ver_none" class="sect2"><h3>Importing with No Version Fragment</h3>
If you import a module <em>without</em> specifying a version fragment, then Zorba will import the highest available version of the module, regardless of major number.This is necessary to support modules from other sources that do not use Zorba's versioning mechanism. However, it is not recommended that you use this kind of import for a module that <em>is</em> versioned, because you cannot control which major version of the module you will get. This could lead to your query breaking in future when an updated, backwards-incompatible version of the module is released. </div>
</div>
    </div>
</div>